# Integration test用 PostgreSQL
# 使い方:
#   docker compose -f tests/integration/docker-compose.yml up -d
#   TEST_DATABASE_URL="postgresql+pg8000://test_user:test_pass@localhost:15432/test_db" \
#     python3 -m pytest tests/integration/ -v
#   docker compose -f tests/integration/docker-compose.yml down

services:
  postgres:
    image: postgres:15-alpine
    environment:
      POSTGRES_USER: test_user
      POSTGRES_PASSWORD: test_pass
      POSTGRES_DB: test_db
    ports:
      - "15432:5432"
    healthcheck:
      test: ["CMD-SHELL", "pg_isready -U test_user -d test_db"]
      interval: 2s
      timeout: 5s
      retries: 5
