# åŒ…æ‹¬çš„ãƒªã‚¹ã‚¯æ˜¯æ­£è¨ˆç”»

**ä½œæˆæ—¥:** 2026-01-30
**ç›®çš„:** å¾¹åº•çš„ãªãƒªã‚¹ã‚¯åˆ†æã§ç™ºè¦‹ã•ã‚ŒãŸå…¨å•é¡Œã®æ˜¯æ­£è¨ˆç”»ã¨å¯¾å¿œçŠ¶æ³ã‚’è¿½è·¡

---

## Document Contractï¼ˆSoTå®£è¨€ï¼‰

| é …ç›® | å†…å®¹ |
|------|------|
| **ã“ã®æ–‡æ›¸ã®å½¹å‰²** | å…¨ãƒªã‚¹ã‚¯ã®æ˜¯æ­£è¨ˆç”»ã¨é€²æ—ç®¡ç† |
| **æ›¸ãã“ã¨** | ãƒªã‚¹ã‚¯ä¸€è¦§ã€æ˜¯æ­£è¨ˆç”»ã€å¯¾å¿œçŠ¶æ³ã€å®Œäº†åŸºæº– |
| **æ›¸ã‹ãªã„ã“ã¨** | æ˜¯æ­£ã®å®Ÿè£…è©³ç´°ï¼ˆâ†’å„è¨­è¨ˆæ›¸ãƒ»ã‚³ãƒ¼ãƒ‰ï¼‰ |
| **SoTï¼ˆã“ã®æ–‡æ›¸ãŒæ­£ï¼‰** | ãƒªã‚¹ã‚¯æ˜¯æ­£ã®å…¨ä½“è¨ˆç”»ã¨é€²æ— |
| **Owner** | Tech Leadï¼ˆé€£çµ¡å…ˆ: #dev ãƒãƒ£ãƒ³ãƒãƒ«ï¼‰ |
| **æ›´æ–°ãƒˆãƒªã‚¬ãƒ¼** | æ˜¯æ­£å®Œäº†æ™‚ã€æ–°è¦ãƒªã‚¹ã‚¯ç™ºè¦‹æ™‚ |

---

## 1. ã‚¨ã‚°ã‚¼ã‚¯ãƒ†ã‚£ãƒ–ã‚µãƒãƒªãƒ¼

### 1.1 ç™ºè¦‹ã•ã‚ŒãŸãƒªã‚¹ã‚¯ç·æ•°

| æ·±åˆ»åº¦ | ä»¶æ•° | å¯¾å¿œçŠ¶æ³ |
|--------|------|---------|
| ğŸ”´ è‡´å‘½çš„ | 5ä»¶ | âœ… 1ä»¶å†è©•ä¾¡æ¸ˆã€**4ä»¶ Tier 1ç·Šæ€¥å¯¾å¿œå®Œäº†ï¼ˆ2026-02-08ï¼‰** |
| ğŸŸ  é«˜å„ªå…ˆåº¦ | 6ä»¶ | âœ… 6ä»¶å…¨å¯¾å¿œå®Œäº† |
| ğŸŸ¡ ä¸­å„ªå…ˆåº¦ | 7ä»¶ | âœ… 5ä»¶å¯¾å¿œå®Œäº†ã€2ä»¶ã¯ç¶™ç¶šå¯¾å¿œ |
| **åˆè¨ˆ** | **18ä»¶** | **16ä»¶å¯¾å¿œå®Œäº†** |

### 1.2 å¯¾å¿œæ–¹é‡

```
ã€åŸå‰‡ã€‘
1. ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒªã‚¹ã‚¯ã¯æœ€å„ªå…ˆã§å¯¾å¿œ
2. è¨­è¨ˆæ›¸ã®çŸ›ç›¾ã¯å®Ÿè£…å‰ã«è§£æ¶ˆ
3. é‹ç”¨æ‰‹é †ã®æ¬ å¦‚ã¯æœ¬ç•ªéšœå®³å‰ã«è£œå®Œ
4. ãƒ†ã‚¹ãƒˆæˆ¦ç•¥ã¯æ®µéšçš„ã«å¼·åŒ–
```

---

## 2. è‡´å‘½çš„ãƒªã‚¹ã‚¯ï¼ˆğŸ”´ï¼‰ã®æ˜¯æ­£è¨ˆç”»

### 2.1 SQLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³è„†å¼±æ€§ã€å†è©•ä¾¡: ãƒªã‚¹ã‚¯ä½ã€‘

| é …ç›® | å†…å®¹ |
|------|------|
| **ç™ºè¦‹å ´æ‰€** | api/app/api/v1/knowledge.py è¡Œ240, 246 |
| **å½“åˆè©•ä¾¡** | è‡´å‘½çš„ |
| **å†è©•ä¾¡çµæœ** | **ãƒªã‚¹ã‚¯ä½ï¼ˆãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°æ¨å¥¨ï¼‰** |

**å†è©•ä¾¡ç†ç”±:**
```python
# å®Ÿéš›ã®ã‚³ãƒ¼ãƒ‰åˆ†æ
conditions.append("category = :category")  # ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼
params["category"] = category              # å€¤ã¯è¾æ›¸çµŒç”±ã§æ¸¡ã•ã‚Œã‚‹

# where_clauseã¯ä»¥ä¸‹ã®ã‚ˆã†ãªæ–‡å­—åˆ—ã«ãªã‚‹
# "organization_id = :org_id AND category = :category"
# ãƒ¦ãƒ¼ã‚¶ãƒ¼å…¥åŠ›ã¯å…¨ã¦:paramå½¢å¼ã§ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿åŒ–ã•ã‚Œã¦ã„ã‚‹
```

**çµè«–:**
- ç¾åœ¨ã®ã‚³ãƒ¼ãƒ‰ã¯SQLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ã«å¯¾ã—ã¦**å®‰å…¨**
- ãŸã ã—f-stringã§SQLæ§‹ç¯‰ã¯ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ã§ã¯ãªã„
- SQLAlchemy ORMã¸ã®ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ã‚’**æ¨å¥¨**ï¼ˆå¿…é ˆã§ã¯ãªã„ï¼‰

**å¯¾å¿œ:**
- [ ] ã‚³ãƒ¼ãƒ‰ãƒ¬ãƒ“ãƒ¥ãƒ¼æ™‚ã«SQLãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’ç¢ºèªã™ã‚‹ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆè¿½åŠ 
- [ ] å°†æ¥çš„ã«SQLAlchemy ORMã¸ç§»è¡Œæ¤œè¨

---

### 2.2 organization_idãƒ•ã‚£ãƒ«ã‚¿æ¼ã‚Œï¼ˆ114ç®‡æ‰€ï¼‰âœ… **æ˜¯æ­£å®Œäº†ï¼ˆ2026-02-08ï¼‰**

| é …ç›® | å†…å®¹ |
|------|------|
| **ç™ºè¦‹å ´æ‰€** | å…¨ã‚µãƒ¼ãƒ“ã‚¹ã€114ã‚¯ã‚¨ãƒª |
| **å¯¾å¿œçŠ¶æ³** | âœ… **å…¨ç®‡æ‰€ä¿®æ­£å®Œäº†** |
| **å®Œäº†å†…å®¹** | personsã‚¹ã‚­ãƒ¼ãƒå¤‰æ›´ + å…¨ãƒ•ã‚¡ã‚¤ãƒ«org_idãƒ•ã‚£ãƒ«ã‚¿ãƒ¼è¿½åŠ  + 3ã‚³ãƒ”ãƒ¼åŒæœŸ + 8,063ãƒ†ã‚¹ãƒˆå…¨PASS |

**å½±éŸ¿ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆå†ç›£æŸ»çµæœï¼‰:**
| ãƒ•ã‚¡ã‚¤ãƒ« | ç®‡æ‰€æ•° | ãƒ†ãƒ¼ãƒ–ãƒ« |
|---------|--------|---------|
| lib/person_service.py (Ã—2ã‚³ãƒ”ãƒ¼) | 10 | persons, person_attributes, person_events |
| main.pyï¼ˆãƒ«ãƒ¼ãƒˆï¼‰ | 6 | persons |
| chatwork-webhook/main.py | 5 | chatwork_tasks |
| chatwork-webhook/handlers/task_handler.py | 4 | chatwork_tasks |
| api/app/api/v1/tasks.py | 3 | chatwork_tasks |
| remind-tasks/main.py | 13 | persons, chatwork_tasks |
| sync-chatwork-tasks/main.py | 21 | persons, chatwork_tasks |
| check-reply-messages/main.py | 7+ | persons, chatwork_tasksï¼ˆã‚µãƒ¼ãƒ“ã‚¹å…¨ä½“ã«org_idå‚ç…§ã‚¼ãƒ­ï¼‰ |
| cleanup-old-data/main.py | 13+ | persons, chatwork_tasksï¼ˆã‚µãƒ¼ãƒ“ã‚¹å…¨ä½“ã«org_idå‚ç…§ã‚¼ãƒ­ï¼‰ |
| lib/brain/memory_access.py | 3 | persons, person_attributes, chatwork_tasks |
| lib/detection/bottleneck_detector.py | 3 | bottlenecké–¢é€£ |
| pattern-detection/lib/detection/emotion_detector.py | 2 | emotioné–¢é€£ï¼ˆorg_idã‚’user_idã¨ã—ã¦èª¤ä½¿ç”¨ï¼‰ |

**æ˜¯æ­£è¨ˆç”»:**

| Phase | å†…å®¹ | æ‹…å½“ | æœŸé™ |
|-------|------|------|------|
| 1 | ãƒ†ãƒ¼ãƒ–ãƒ«ã‚¹ã‚­ãƒ¼ãƒå¤‰æ›´ï¼ˆorganization_idã‚«ãƒ©ãƒ è¿½åŠ ï¼‰ | DBæ‹…å½“ | Phase 4A-2é€±é–“å‰ |
| 2 | æ—¢å­˜ãƒ‡ãƒ¼ã‚¿ã®organization_idè¨­å®šï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: org_soulsyncsï¼‰ | DBæ‹…å½“ | Phase 4A-2é€±é–“å‰ |
| 3 | 23ç®‡æ‰€ã®ã‚¯ã‚¨ãƒªä¿®æ­£ | é–‹ç™ºæ‹…å½“ | Phase 4A-1é€±é–“å‰ |
| 4 | çµ„ç¹”åˆ†é›¢ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹è¿½åŠ ãƒ»å®Ÿè¡Œ | QAæ‹…å½“ | Phase 4Aé–‹å§‹æ™‚ |

**ä¿®æ­£ãƒ‘ã‚¿ãƒ¼ãƒ³:**
```python
# Before
cursor.execute("SELECT value FROM system_config WHERE key = %s", (key,))

# After
cursor.execute("""
    SELECT value FROM system_config
    WHERE key = %s AND organization_id = %s
""", (key, ORGANIZATION_ID))
```

**è©³ç´°:** â†’ `SECURITY_AUDIT_ORGANIZATION_ID.md`

---

### 2.3 APIèªè¨¼ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢æœªå®Ÿè£… âœ… **æ˜¯æ­£å®Œäº†ï¼ˆ2026-02-08ï¼‰**

| é …ç›® | å†…å®¹ |
|------|------|
| **ç™ºè¦‹å ´æ‰€** | api/app/api/v1/knowledge.py |
| **å¯¾å¿œçŠ¶æ³** | âœ… **JWTèªè¨¼ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢å®Ÿè£…å®Œäº†** |
| **å®Œäº†å†…å®¹** | `api/app/deps/auth.py` æ–°è¦ä½œæˆã€å…¨ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆJWTå¿…é ˆåŒ–ã€Cloud Run 11ã‚µãƒ¼ãƒ“ã‚¹èªè¨¼çµ±ä¸€ã€35ãƒ†ã‚¹ãƒˆPASS |

**ç¾çŠ¶ã®ã‚³ãƒ¼ãƒ‰:**
```python
# å•é¡Œ: èªè¨¼ãªã—ã§ãƒ˜ãƒƒãƒ€ãƒ¼ã‚’ä¿¡é ¼
async def get_current_user(
    x_user_id: str = Header(...),
    x_tenant_id: str = Header(...),
) -> UserContext:
```

**æ˜¯æ­£è¨ˆç”»:**

| Phase | å†…å®¹ | æ‹…å½“ | æœŸé™ |
|-------|------|------|------|
| 1 | JWTèªè¨¼ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢è¨­è¨ˆ | ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£æ‹…å½“ | 2é€±é–“ä»¥å†… |
| 2 | èªè¨¼ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢å®Ÿè£… | é–‹ç™ºæ‹…å½“ | 4é€±é–“ä»¥å†… |
| 3 | å…¨ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã¸ã®é©ç”¨ | é–‹ç™ºæ‹…å½“ | Phase 4Aå‰ |
| 4 | èªè¨¼ãƒã‚¤ãƒ‘ã‚¹ãƒ†ã‚¹ãƒˆ | QAæ‹…å½“ | Phase 4Aå‰ |

**è¨­è¨ˆè¦ä»¶:**
- JWTãƒˆãƒ¼ã‚¯ãƒ³æ¤œè¨¼
- ãƒ†ãƒŠãƒ³ãƒˆIDæ¤œè¨¼ï¼ˆãƒˆãƒ¼ã‚¯ãƒ³å†…ã®claimï¼‰
- ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥ãƒˆãƒ¼ã‚¯ãƒ³å¯¾å¿œ
- èªè¨¼å¤±æ•—æ™‚ã®é©åˆ‡ãªã‚¨ãƒ©ãƒ¼ãƒ¬ã‚¹ãƒãƒ³ã‚¹ï¼ˆ401/403ï¼‰

---

### 2.4 RLSï¼ˆRow Level Securityï¼‰æœªå®Ÿè£… âœ… **æ˜¯æ­£å®Œäº†ï¼ˆ2026-02-08ï¼‰**

| é …ç›® | å†…å®¹ |
|------|------|
| **ç™ºè¦‹å ´æ‰€** | å…¨ãƒ†ãƒŠãƒ³ãƒˆãƒ†ãƒ¼ãƒ–ãƒ« |
| **å¯¾å¿œçŠ¶æ³** | âœ… **48ãƒ†ãƒ¼ãƒ–ãƒ«è¿½åŠ RLSæœ‰åŠ¹åŒ–ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ä½œæˆå®Œäº†** |
| **å®Œäº†å†…å®¹** | `migrations/20260208_rls_expansion.sql` (48ãƒ†ãƒ¼ãƒ–ãƒ«) + ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯ã‚¹ã‚¯ãƒªãƒ—ãƒˆä½œæˆã€æ—¢å­˜21ãƒ†ãƒ¼ãƒ–ãƒ«(brain_*)ã¨åˆã‚ã›ã¦å…¨ãƒ†ãƒŠãƒ³ãƒˆãƒ†ãƒ¼ãƒ–ãƒ«RLSå¯¾å¿œ |

**æ˜¯æ­£è¨ˆç”»:** â†’ ãƒ­ãƒ¼ãƒ‰ãƒãƒƒãƒ—è¨ˆç”» Tier 1-3 ã«è©³ç´°è¨˜è¼‰

**å¯¾è±¡ãƒ†ãƒ¼ãƒ–ãƒ«ï¼ˆ52å€‹ã€4ã‚°ãƒ«ãƒ¼ãƒ—ï¼‰:**
- Tier 1-A: ã‚³ã‚¢ãƒ‡ãƒ¼ã‚¿21ãƒ†ãƒ¼ãƒ–ãƒ«ï¼ˆdocuments, goals, user_preferencesç­‰ï¼‰
- Tier 1-B: æ©Ÿèƒ½ãƒ†ãƒ¼ãƒ–ãƒ«16ãƒ†ãƒ¼ãƒ–ãƒ«ï¼ˆemotion_scores, proactive_action_logsç­‰ï¼‰
- Tier 1-C: ãƒ­ã‚°ãƒ»åˆ†æ8ãƒ†ãƒ¼ãƒ–ãƒ«ï¼ˆai_usage_logs, audit_logsç­‰ï¼‰
- Tier 1-D: personsé–¢é€£3ãƒ†ãƒ¼ãƒ–ãƒ«ï¼ˆã‚¹ã‚­ãƒ¼ãƒå¤‰æ›´å¾Œï¼‰
- ceo_teachingsé–¢é€£4ãƒ†ãƒ¼ãƒ–ãƒ«ï¼ˆTier 3ã§å¯¾å¿œï¼‰
- ãƒã‚¹ã‚¿ãƒ¼2ãƒ†ãƒ¼ãƒ–ãƒ«ã¯RLSä¸è¦ï¼ˆai_model_registry, goal_setting_patternsï¼‰

**å®Ÿè£…æ‰‹é †:**
1. ãƒ†ã‚¹ãƒˆç’°å¢ƒã§RLSãƒãƒªã‚·ãƒ¼æ¤œè¨¼
2. FORCE ROW LEVEL SECURITYã‚’å…¨ãƒ†ãƒ¼ãƒ–ãƒ«ã«é©ç”¨
3. æœ¬ç•ªç’°å¢ƒã§æ®µéšçš„æœ‰åŠ¹åŒ–ï¼ˆãƒ†ãƒ¼ãƒ–ãƒ«ã”ã¨ï¼‰
4. ãƒ†ãƒŠãƒ³ãƒˆåˆ†é›¢ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ

---

### 2.5 LLM Brainå±¤ã®è¨­è¨ˆvså®Ÿè£…ä¹–é›¢ âœ… **æ˜¯æ­£å®Œäº†ï¼ˆ2026-01-31ï¼‰**

| é …ç›® | å†…å®¹ |
|------|------|
| **ç™ºè¦‹å ´æ‰€** | proactive-monitor/lib/brain/ |
| **å½“åˆå•é¡Œ** | è¨­è¨ˆã¯ã€ŒLLMå¸¸é§å‹ã€ã€å®Ÿè£…ã¯ã€Œã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ãƒãƒƒãƒ+ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ã€ |
| **å½“åˆå®Ÿè£…åº¦** | 15% |
| **ç¾åœ¨å®Ÿè£…åº¦** | **100%ï¼ˆã‚³ã‚¢å±¤ï¼‰** |
| **å¯¾å¿œçŠ¶æ³** | âœ… **LLMBrainå®Ÿè£…å®Œäº†ã€USE_BRAIN_ARCHITECTURE=true ã§æœ¬ç•ªç¨¼åƒä¸­** |

**æ˜¯æ­£å®Œäº†å†…å®¹:**
- LLMBrainã‚¯ãƒ©ã‚¹: `lib/brain/llm_brain.py`ï¼ˆ1,249è¡Œï¼‰âœ…
- Claude APIé€£æºï¼ˆFunction Callingå½¢å¼ï¼‰: `lib/brain/tool_converter.py` âœ…
- Context Builder: `lib/brain/context_builder.py`ï¼ˆ686è¡Œï¼‰âœ…
- Chain-of-Thought: System Promptã§å¼·åˆ¶ âœ…
- Guardian Layer: `lib/brain/guardian_layer.py`ï¼ˆ522è¡Œï¼‰âœ…

**æ®‹èª²é¡Œï¼ˆä½å„ªå…ˆåº¦ï¼‰:**
- Observability DBæ°¸ç¶šåŒ–: 60%ï¼ˆCloud Loggingã®ã¿ã€DBæœªå®Ÿè£…ï¼‰
- Tool Executoråˆ†é›¢: 70%ï¼ˆBrainExecutionã§ä»£ç”¨ä¸­ï¼‰

**è©³ç´°:** â†’ `DESIGN_IMPLEMENTATION_GAP_REPORT.md`

---

## 3. é«˜å„ªå…ˆåº¦ãƒªã‚¹ã‚¯ï¼ˆğŸŸ ï¼‰ã®æ˜¯æ­£è¨ˆç”»

### 3.1 CLAUDE.mdã¨25ç« ã®æ¨©é™å®šç¾©çŸ›ç›¾ âœ… å¯¾å¿œå®Œäº†

| é …ç›® | å†…å®¹ |
|------|------|
| **å•é¡Œ** | CLAUDE.md: è„³ãŒã€Œåˆ¤æ–­ã€/ 25ç« : è„³ã¯ã€Œææ¡ˆã€ã€GuardianãŒã€Œåˆ¤æ–­ã€ |
| **å¯¾å¿œ** | CLAUDE.mdã«ã‚»ã‚¯ã‚·ãƒ§ãƒ³2-3ã€Œ3å±¤åˆ¤æ–­ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã€è¿½åŠ  |
| **å¯¾å¿œçŠ¶æ³** | âœ… **å®Œäº†**ï¼ˆ2026-01-30ï¼‰ |

### 3.2 Context Builderå±¤æœªå®Ÿè£… âœ… **æ˜¯æ­£å®Œäº†ï¼ˆ2026-01-31ï¼‰**

| é …ç›® | å†…å®¹ |
|------|------|
| **å½“åˆå®Ÿè£…åº¦** | 30% |
| **ç¾åœ¨å®Ÿè£…åº¦** | **100%** |
| **å¯¾å¿œçŠ¶æ³** | âœ… **å®Œäº†** - `lib/brain/context_builder.py`ï¼ˆ686è¡Œï¼‰ã€LLMContextå®Ÿè£…æ¸ˆã¿ã€Truthé †ä½ã®å³å¯†é©ç”¨æ¸ˆã¿ |

### 3.3 å¤–éƒ¨ã‚µãƒ¼ãƒ“ã‚¹éšœå®³å¯¾å¿œã®æ¬ å¦‚ âœ… å¯¾å¿œå®Œäº†

| ã‚µãƒ¼ãƒ“ã‚¹ | å¯¾å¿œçŠ¶æ³ | å¯¾å¿œå†…å®¹ |
|---------|---------|---------|
| Google Drive API | âœ… å¯¾å¿œæ¸ˆ | OPERATIONS_RUNBOOK ã‚»ã‚¯ã‚·ãƒ§ãƒ³12.1è¿½åŠ  |
| Pinecone | âœ… å¯¾å¿œæ¸ˆ | OPERATIONS_RUNBOOK ã‚»ã‚¯ã‚·ãƒ§ãƒ³12.2è¿½åŠ  |
| DNS | âœ… å¯¾å¿œæ¸ˆ | OPERATIONS_RUNBOOK ã‚»ã‚¯ã‚·ãƒ§ãƒ³12.3è¿½åŠ  |

### 3.4 ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å¤±æ•—å¯¾å¿œã®æ¬ å¦‚ âœ… å¯¾å¿œå®Œäº†

| é …ç›® | å†…å®¹ |
|------|------|
| **å•é¡Œ** | DBã‚¹ã‚­ãƒ¼ãƒå¤‰æ›´æ™‚ã®ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯æ‰‹é †ãŒãªã„ |
| **å¯¾å¿œ** | OPERATIONS_RUNBOOK ã‚»ã‚¯ã‚·ãƒ§ãƒ³14è¿½åŠ  |
| **å¯¾å¿œçŠ¶æ³** | âœ… **å®Œäº†**ï¼ˆ2026-01-30ï¼‰ |

### 3.5 ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸è¨ˆæ¸¬ãªã— âœ… å¯¾å¿œå®Œäº†

| é …ç›® | å†…å®¹ |
|------|------|
| **å•é¡Œ** | 80%åŸºæº–ãŒæ¤œè¨¼ã•ã‚Œã¦ã„ãªã„ |
| **å¯¾å¿œ** | `.github/workflows/test-coverage.yml` è¿½åŠ  |
| **å¯¾å¿œçŠ¶æ³** | âœ… **å®Œäº†**ï¼ˆ2026-01-30ï¼‰|

---

## 4. ä¸­å„ªå…ˆåº¦ãƒªã‚¹ã‚¯ï¼ˆğŸŸ¡ï¼‰ã®æ˜¯æ­£è¨ˆç”»

| # | ãƒªã‚¹ã‚¯ | å¯¾å¿œå†…å®¹ | çŠ¶æ³ |
|---|--------|---------|------|
| 1 | ~~DDoSæ”»æ’ƒå¯¾å¿œãªã—~~ | OPERATIONS_RUNBOOK ã‚»ã‚¯ã‚·ãƒ§ãƒ³15è¿½åŠ  | âœ… å®Œäº† |
| 2 | ~~ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—å¾©æ—§ãƒ†ã‚¹ãƒˆãªã—~~ | DISASTER_DRILL_PLAN DR-007è¿½åŠ  | âœ… å®Œäº† |
| 3 | E2Eãƒ†ã‚¹ãƒˆã‚·ãƒŠãƒªã‚ªä¸è¶³ | ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹è¿½åŠ  | â³ ç¶™ç¶šå¯¾å¿œ |
| 4 | ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆå®Ÿè£…ãªã— | ãƒ†ã‚¹ãƒˆå®Ÿè£… | â³ ç¶™ç¶šå¯¾å¿œ |
| 5 | ~~ã‚³ã‚¹ãƒˆä¸Šé™ãƒ†ã‚¹ãƒˆæœªå®šç¾©~~ | 09ç«  11.8ï¼ˆä»•æ§˜ï¼‰+ test-coverage.ymlï¼ˆåŸºç›¤ï¼‰è¿½åŠ  | âœ… ä»•æ§˜å®šç¾©å®Œäº†ï¼ˆå®Ÿè£…ã¯Phase 4ï¼‰ |
| 6 | ~~Phaseç•ªå·ã®æ··ä¹±~~ | DESIGN_COVERAGE_MATRIXã§æ•´ç†æ¸ˆã¿ | âœ… å®Œäº† |
| 7 | ~~09ç« ã®SoTçŸ›ç›¾~~ | Document Contractè¿½åŠ ã§è§£æ¶ˆ | âœ… å®Œäº† |

---

## 5. æ˜¯æ­£å®Œäº†ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

### Tier 1ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç·Šæ€¥ï¼ˆå³æ™‚å¯¾å¿œï¼‰âœ… **å…¨å®Œäº†ï¼ˆ2026-02-08ï¼‰**

- [x] organization_idãƒ•ã‚£ãƒ«ã‚¿114ç®‡æ‰€ä¿®æ­£ï¼ˆpersonsã‚¹ã‚­ãƒ¼ãƒå¤‰æ›´å«ã‚€ï¼‰âœ… PR #421
- [x] RLSãƒãƒªã‚·ãƒ¼48ãƒ†ãƒ¼ãƒ–ãƒ«æ‹¡å¤§ âœ… `migrations/20260208_rls_expansion.sql`
- [x] APIèªè¨¼ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢(JWT)å®Ÿè£… âœ… `api/app/deps/auth.py`
- [x] Cloud Runèªè¨¼çµ±ä¸€ï¼ˆ11ã‚µãƒ¼ãƒ“ã‚¹â†’èªè¨¼å¿…é ˆåŒ–ï¼‰âœ… 6ãƒ•ã‚¡ã‚¤ãƒ«deploy.shä¿®æ­£
- [x] ILIKEãƒ‘ã‚¿ãƒ¼ãƒ³ã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ä¿®æ­£ï¼ˆ12+ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰âœ… `escape_ilike()` + `ESCAPE '\\'`
- [x] Supabase ANON key Secret Managerç§»è¡Œ âœ… deploy.sh + org_chart_service.py
- [x] çµ„ç¹”åˆ†é›¢ãƒ†ã‚¹ãƒˆå®Œäº† âœ… `tests/test_org_isolation.py` + `tests/test_ilike_escape.py`

### æ˜¯æ­£å®Œäº†

- [x] LLM Brainå±¤ã®å¸¸é§åŒ– âœ… **2026-01-31å®Œäº†**ï¼ˆ100%ã€æœ¬ç•ªç¨¼åƒä¸­ï¼‰
- [x] Context Builderå±¤å®Ÿè£… âœ… **2026-01-31å®Œäº†**ï¼ˆ100%ï¼‰
- [x] å¤–éƒ¨ã‚µãƒ¼ãƒ“ã‚¹éšœå®³å¯¾å¿œæ‰‹é †è¿½åŠ  âœ… **2026-01-30å®Œäº†**
- [x] ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸CI/CDè¿½åŠ  âœ… **2026-01-30å®Œäº†**

### ç¶™ç¶šçš„æ”¹å–„

- [ ] E2Eãƒ†ã‚¹ãƒˆã‚·ãƒŠãƒªã‚ªæ‹¡å……
- [ ] ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆè‡ªå‹•åŒ–
- [x] ã‚³ã‚¹ãƒˆç›£è¦–ãƒ»ã‚¢ãƒ©ãƒ¼ãƒˆè¨­å®š âœ… **2026-01-30ä»•æ§˜å®šç¾©å®Œäº†**ï¼ˆ09ç«  11.8 + CI/CDåŸºç›¤ã€å®Ÿè£…ã¯Phase 4ï¼‰

---

## 6. é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

| ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ | å‚ç…§å†…å®¹ |
|-------------|---------|
| SECURITY_AUDIT_ORGANIZATION_ID.md | organization_idç›£æŸ»è©³ç´° |
| RLS_POLICY_DESIGN.md | RLSãƒãƒªã‚·ãƒ¼è¨­è¨ˆ |
| DESIGN_IMPLEMENTATION_GAP_REPORT.md | è¨­è¨ˆvså®Ÿè£…ã®ä¹–é›¢è©³ç´° |
| OPERATIONS_RUNBOOK.md | é‹ç”¨æ‰‹é † |
| DISASTER_DRILL_PLAN.md | éšœå®³è¨“ç·´è¨ˆç”» |

---

## æ›´æ–°å±¥æ­´

| æ—¥ä»˜ | å¤‰æ›´å†…å®¹ |
|------|---------|
| 2026-01-30 | åˆç‰ˆä½œæˆï¼ˆ18ä»¶ã®ãƒªã‚¹ã‚¯æ˜¯æ­£è¨ˆç”»ç­–å®šï¼‰ |
| 2026-01-30 | æ˜¯æ­£å®Œäº†: CLAUDE.md/25ç« çŸ›ç›¾è§£æ¶ˆã€å¤–éƒ¨ã‚µãƒ¼ãƒ“ã‚¹éšœå®³å¯¾å¿œã€ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å¤±æ•—å¯¾å¿œã€ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸CI/CDã€ã‚³ã‚¹ãƒˆä¸Šé™ãƒ†ã‚¹ãƒˆã€DDoSå¯¾å¿œã€ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—å¾©æ—§ãƒ†ã‚¹ãƒˆï¼ˆè¨ˆ11ä»¶å®Œäº†ï¼‰ |
| 2026-02-08 | å…¨é¢å†ç›£æŸ»: org_idæ¼ã‚Œ23â†’114ç®‡æ‰€ã€RLS 8â†’52ãƒ†ãƒ¼ãƒ–ãƒ«è¦å¯¾å¿œã€LLM Brain 15%â†’100%æ˜¯æ­£å®Œäº†ã€Context Builder 30%â†’100%æ˜¯æ­£å®Œäº†ã€ILIKEã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³è„†å¼±æ€§è¿½åŠ  |
| **2026-02-08** | **Tier 1ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç·Šæ€¥ å…¨7é …ç›®æ˜¯æ­£å®Œäº†: org_idãƒ•ã‚£ãƒ«ã‚¿114ç®‡æ‰€ä¿®æ­£ã€RLS 48ãƒ†ãƒ¼ãƒ–ãƒ«æ‹¡å¤§ã€JWTèªè¨¼ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢å®Ÿè£…ã€Cloud Runèªè¨¼çµ±ä¸€ã€ILIKEã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ä¿®æ­£ã€Supabase ANON keyç§»è¡Œã€çµ„ç¹”åˆ†é›¢ãƒ†ã‚¹ãƒˆè¿½åŠ ï¼ˆPR #421ï¼‰** |
| 2026-02-08 | Codexãƒ¬ãƒ“ãƒ¥ãƒ¼å¾Œä¿®æ­£: RLSãƒãƒªã‚·ãƒ¼type castçµ±ä¸€ï¼ˆdaily_activity_logs ::uuidè¿½åŠ ï¼‰ã€Secret Managerä¾‹å¤–ãƒ­ã‚°è¿½åŠ ã€type castãƒ‘ã‚¿ãƒ¼ãƒ³èª¬æ˜ã‚³ãƒ¡ãƒ³ãƒˆè¿½è¨˜ |

---

### æ®‹å­˜ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚¢ã‚¤ãƒ†ãƒ ï¼ˆã‚¤ãƒ³ãƒ•ãƒ©ä½œæ¥­ï¼‰

| # | é …ç›® | å¯¾å¿œæ–¹æ³• | å„ªå…ˆåº¦ |
|---|------|---------|--------|
| 1 | **Supabase ANON keyãƒ­ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³** | Supabase Dashboard > Settings > API ã§ã‚­ãƒ¼å†ç”Ÿæˆ â†’ GCP Secret Manager `SUPABASE_ANON_KEY` ã‚’æ›´æ–° | ğŸ”´ é«˜ï¼ˆGitå±¥æ­´ã«æ—§ã‚­ãƒ¼æ®‹å­˜ï¼‰ |
| 2 | daily_activity_logs ã‚«ãƒ©ãƒ å‹ç¢ºèª | æœ¬ç•ªDBã§ `SELECT data_type FROM information_schema.columns WHERE table_name='daily_activity_logs' AND column_name='organization_id'` ã‚’å®Ÿè¡Œã—ã€::uuid ãŒæ­£ã—ã„ã‹æ¤œè¨¼ | ğŸŸ¡ ä¸­ |

---

**ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã«ã¤ã„ã¦ã®è³ªå•ã¯ã€Tech Leadã«é€£çµ¡ã—ã¦ãã ã•ã„ã€‚**
