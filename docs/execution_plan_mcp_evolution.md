# ソウル君 進化実行計画書（3AIレビュー反映 最終版）

**作成日:** 2026-02-17
**最終更新:** 2026-02-18（実装完了状況を反映）
**作成者:** 3AI合議（Claude Opus 4.6 + Codex GPT-5.2 + Gemini 3 Flash）
**宛先:** CEO カズさん
**ステータス:** Step 0〜D 全完了。Step E（外販準備）のみ未着手。
**版:** v2.1（実装完了状況を反映）

---

## この計画書の目的

前回の3AIレビューで合意した方針「**脳みそはそのまま。手足と窓口を追加する。**」を、
具体的に「いつ・何を・どの順番で」やるかを決めた実行計画書です。

---

## 現在のソウル君の状態（2026-02-18時点）

| 項目 | 現状 |
|------|------|
| **脳みそ** | 独自の3層構造で稼働中（GPT-5.2エンジン） |
| **できること** | 27個の業務機能（タスク管理、目標管理、議事録、文書作成など） |
| **窓口** | ChatWork + Telegram（社長専用）— 両方稼働中 |
| **手足** | MCP経由でコマンド実行可能（安全なサンドボックス内） |
| **道具の共通規格（MCP）** | Web検索・Googleカレンダー・Googleドライブ接続済み |
| **Googleカレンダー連携** | OAuth完了済み。脳がMCP経由でカレンダーを操作可能 |
| **画像認識AI** | Telegram・ChatWork両対応（Vision AI bypass handler） |
| **テスト** | 6,694件+（品質チェックの仕組みが充実） |
| **安全装置** | 番人（Guardian Layer）＋権限チェック（Auth Gate）＋承認ゲート稼働中 |
| **監査ログ** | 稼働中（誰が何をしたかの記録。保持期間1年。MCP操作ログも記録） |
| **Cloud Run移行** | 完了済み（PR #509） |

---

## 全体スケジュール（3AIレビュー反映版）

**2026-02-18時点の実装状況（git履歴に基づく事実）：**

```
【Step 0】安全の土台作り ─── ✅ 完了（PR #551）
   ↓
【Step A】道具の追加 ─── ✅ 完了（PR #552〜#557, #567〜#568）
   ↓
【Step B】テレグラム窓口 ─── ✅ 完了（PR #555, #575〜#577）
   ↓
【Step C】手足を与える ─── ✅ 完了（PR #558〜#566）
   ↓
【Step D】マニュアル整理 ─── ✅ 完了（PR #571〜#573）
   ↓
【追加】画像認識AI ─── ✅ 完了（PR #579〜#583）
   ↓
【追加】Cloud Run移行 ─── ✅ 完了（PR #509）
   ↓
【Step E】外販準備 ─── 🔲 未着手（安全性の基準を満たしてから）
```

**Step 0〜Dは全て完了。残るはStep E（外販準備＝SaaS化）のみ。**

---

## ★ Step 0：安全の土台作り（3AIレビューで追加）— ✅ 完了（PR #551）

### 何をするか（小学生向け説明）

道具や手足を与える**前に**、「何をやったら危ないか」「誰が何を許可するか」「問題が起きたらどう止めるか」のルールを先に作ります。

たとえると、**秘書に新しい仕事を任せる前に、「業務マニュアル」と「緊急連絡先」を整備する**ようなものです。

### なぜ先にやるか（Codexの指摘）

> 「道具を増やすほど事故の面積が増える。先に制御の仕組みがないと、拡大が止まらない」— Codex

### やること一覧

| # | やること | たとえると | 期間 |
|---|---------|-----------|------|
| 0-1 | **承認ゲート（＝許可の仕組み）の設計** | 「低リスクは自動OK、中リスクは社長に確認、高リスクは二段階チェック」というルールを作る | 3〜5日 |
| 0-2 | **監査ログ（＝記録の仕組み）の強化** | 新しい道具を使った記録が「誰が・いつ・何を・なぜ・結果どうなったか」全て残るようにする | 2〜3日 |
| 0-3 | **緊急停止ボタンの設置** | 何か問題が起きたら、一発でソウル君の新機能を全て止められるスイッチを作る | 2〜3日 |
| 0-4 | **社長不在時のルール策定** | 社長が出張中や休暇中に緊急事態が起きた場合の対応手順を決める | 1〜2日 |

### 承認ゲートの3段階（Codexの提案を採用）

| 危険度 | 例 | 処理 |
|--------|---|------|
| **低**（読み取りのみ） | カレンダーの予定を見る、Web検索 | 自動でOK（番人が記録だけする） |
| **中**（書き込みあり） | カレンダーに予定を追加、ファイルを作成 | 社長に確認メッセージ → 承認後に実行 |
| **高**（取り消し困難） | データの削除、外部への送信、権限変更 | 社長が承認 → さらに番人がダブルチェック → 実行 |

### 緊急停止ボタン（Codex・Gemini両方が要求）

- 管理画面に「**緊急停止**」ボタンを設置
- 押すと、Step A以降で追加した全ての新機能が即座に停止
- 既存の27個の機能はそのまま動き続ける（業務は止まらない）
- 社長がテレグラム or ChatWorkから「停止」と一言送るだけでも停止可能

### 社長不在時のルール

| 状況 | 対応 |
|------|------|
| 社長が数時間不在 | 中リスク以上の操作は「保留」にして社長の戻りを待つ |
| 社長が1日以上不在 | 事前に指定した代理人（例：管理部長）が中リスクの承認可能 |
| 緊急事態（データ破損等） | 緊急停止ボタンを誰でも押せる。その後社長に即報告 |

---

## Step A：道具を追加する（元Phase 2の一部）— ✅ 完了（PR #552〜#557, #567〜#568）

### 何をするか（小学生向け説明）

ソウル君が「Web検索」「Googleカレンダー」「Googleドライブ」を自分で使えるようにします。
今は社長やスタッフが自分でカレンダーを開いて確認していますが、
ソウル君に「明日の予定教えて」と言うだけで答えてくれるようになります。

### やること一覧（期間を現実的に修正）

| # | やること | たとえると | 期間 |
|---|---------|-----------|------|
| A-1 | **Web検索の道具を追加** | 秘書にスマホを渡す。自分でネットを調べられるようになる | 5〜7日 |
| A-2 | **動作確認とテスト** | 実際にいろんな質問をしてみて、ちゃんと動くか確認 | 3〜5日 |
| A-3 | **Googleカレンダーの道具を追加** | 秘書に社長の手帳を見せる。予定を確認できるようになる（最初は読み取りのみ） | 5〜7日 |
| A-4 | **動作確認とテスト** | 予定の確認がちゃんとできるか、間違った予定を見せないか確認 | 3〜5日 |
| A-5 | **Googleドライブの道具を追加** | 秘書にファイルキャビネットの鍵を渡す。資料を探せるようになる（最初は読み取りのみ） | 7〜10日 |
| A-6 | **動作確認とテスト** | ファイルの検索がちゃんとできるか、見せてはいけないファイルを見せないか確認 | 3〜5日 |

### なぜこの順番か

- **Web検索**：一番リスクが低い（情報を「読む」だけで、何かを「書き換える」ことがない）
- **Googleカレンダー**：OAuth（＝安全な接続方式）が既に完了している。すぐ繋げられる
- **Googleドライブ**：ファイルの読み書きが絡むので、少し慎重に
- **各道具の後にテスト期間を設けた**（Geminiの指摘：「テスト期間がない」を反映）

### メリット

- 「明日の予定は？」→ ソウル君がカレンダーを見て即回答
- 「○○について調べて」→ ソウル君がネットで調べて要約
- 「先週の会議資料どこ？」→ ソウル君がドライブから探して教えてくれる

### デメリット・リスク（Geminiの指摘を追加）

| リスク | 深刻度 | 対策 |
|--------|:------:|------|
| カレンダーの予定を間違って消す可能性 | 高 | 最初は「読み取りだけ」。書き込みは社長承認後に開放 |
| 検索結果が間違っている可能性 | 中 | 必ず出典（＝情報元のURL）を一緒に表示する |
| ドライブの機密ファイルが見える可能性 | 高 | Googleドライブの権限設定に従う。権限外のファイルは見せない |
| 外部サービス（Google等）が止まった場合 | 中 | 「現在カレンダーに接続できません」と正直に伝える。既存機能は影響なし |
| 個人情報が記録に残る可能性 | 高 | 既存のPII除去（＝個人情報を自動で隠す仕組み）をそのまま適用 |

### 権限ルール（カズさんの要望を反映）

| 操作 | 社長（レベル6） | 幹部（レベル4-5） | 一般スタッフ（レベル1-3） |
|------|:-:|:-:|:-:|
| カレンダーの予定を見る | OK | OK（自分の予定のみ） | OK（自分の予定のみ） |
| カレンダーに予定を追加 | OK | 社長に確認後OK | 不可（「管理部に提案してみるね」→ 社長にDM） |
| Web検索 | OK | OK | OK |
| ドライブのファイルを見る | OK | OK（権限範囲内） | OK（権限範囲内） |
| ドライブにファイルを作る | OK | 社長に確認後OK | 不可（「管理部に提案してみるね」→ 社長にDM） |

---

## Step B：テレグラム窓口を追加する（元Phase 3）— ✅ 完了（PR #555, #575〜#577）

### 何をするか（小学生向け説明）

今はChatWorkからしかソウル君に話しかけられませんが、
テレグラムからも話しかけられるようにします。
**テレグラムは社長専用の窓口**です。スタッフは今まで通りChatWork。

### やること一覧

| # | やること | たとえると | 期間 |
|---|---------|-----------|------|
| B-1 | **テレグラム用の「窓口係」を作る** | 受付に2人目の窓口係を置く。どちらの窓口から来ても、同じ秘書（脳みそ）に繋がる | 5〜7日 |
| B-2 | **社長専用の設定** | 「この窓口は社長だけが使える」という鍵をかける | 2〜3日 |
| B-3 | **トピック機能（＝話題ごとの部屋分け）への対応** | テレグラムの「話題ごとの部屋」にソウル君が対応できるようにする | 3〜5日 |
| B-4 | **動作確認とテスト** | 実際にテレグラムから色々な指示を出して、ちゃんと動くか確認 | 3〜5日 |

### なぜできるのか

ソウル君の設計には「窓口は差し替え可能」という前提が最初から組み込まれています。
ChatWork専用ではなく、**「どんな窓口が来ても対応できるように」**作られているので、
テレグラム用の窓口係を追加するだけで動きます。

### メリット

- **社長はテレグラムから気軽に指示**できる（スマホでサクッと）
- **トピック機能で話題が整理される**（「経営会議」「採用」「開発」など部屋を分けられる）
- **ChatWorkは今まで通り**。スタッフへの影響ゼロ

### デメリット・リスク

| リスク | 対策 |
|--------|------|
| 2つの窓口を管理する手間が増える | テレグラムは社長専用に限定。全社に広げない |
| テレグラムがダウンしたら使えない | ChatWorkが引き続きメインなので、業務に影響なし |
| テレグラムとChatWorkで返答がズレる可能性 | 脳みそは1つなので、どちらから聞いても同じ答え |

### 権限ルール

| 窓口 | 使える人 | 用途 |
|------|---------|------|
| **テレグラム** | 社長のみ（レベル6） | 社長専用の指令チャンネル |
| **ChatWork** | 全スタッフ（レベル1〜6） | 通常業務のやりとり |
| **将来のSlack/LINE等** | 社長が許可した場合のみ追加 | SaaS化時にクライアント用として |

---

## Step C：手足を与える（元Phase 1）— ✅ 完了（PR #558〜#566）

### 何をするか（小学生向け説明）

ソウル君が「自分でコマンド（＝パソコンへの命令）を実行できる」ようにします。
例えば、データの集計や、ファイルの作成を自分でできるようになります。

**これが一番パワフルだけど、一番慎重にやるべきステップです。**

### 3AIの共通見解

> 「コマンド実行はAIに刃物を持たせるのと同じ。慎重すぎるほど慎重に。」— Gemini
> 「最低でも6〜10週間。安全設計が一番重い。」— Codex

### やること一覧（大幅に細分化）

| # | やること | たとえると | 期間 |
|---|---------|-----------|------|
| C-1 | **安全な作業スペースを作る** | 秘書に「鍵付きの個室デスク」を与える。外には勝手に出られない | 10〜14日 |
| C-2 | **「やっていいこと」リスト（読み取りのみ）** | 「この書類は見てOK」だけのリスト。書き換えは一切禁止 | 5〜7日 |
| C-3 | **テストと安全性チェック** | 実際に色々な命令を試して、危ないことができないか確認 | 7〜10日 |
| C-4 | **番人（Guardian Layer）の強化** | 番人に「この秘書が変なことをしたら止めて」という追加ルールを教える | 5〜7日 |
| C-5 | **「やっていいこと」リスト（安全な書き込み）** | 「ファイルを作る」「レポートを書く」を追加。ただし削除は禁止 | 5〜7日 |
| C-6 | **全体テストと安定化** | 2週間の安定運用を確認してから次の段階へ | 14日 |

### なぜ最後にやるのか（3AI全員一致）

- **リスクが一番大きい**ステップだから
- Step AとBで「道具」と「窓口」が安定してから、慎重に進めるべき
- 「手足」は一度与えると影響範囲が大きい。間違った操作をした場合の被害が大きい

### メリット

- 「このデータを集計して」→ ソウル君が自分で集計して報告
- 「この資料を作って」→ ソウル君が自分でファイルを作成
- 社長の「分身」感が最も強くなるステップ

### デメリット・リスク（Codex・Geminiの指摘を全て反映）

| リスク | 深刻度 | 対策 |
|--------|:------:|------|
| 間違ったデータを書き換える | 高 | 「書き換え」は最初は禁止。読み取りのみから開始 |
| 外部サービスに間違った操作をする | 高 | 外部への書き込みは全て社長の事前承認を必須にする |
| 想定外のコマンドを実行する | 高 | 「やっていいこと」をリスト化（許可制）。リストにないことは実行不可 |
| AIを騙して危険な命令を実行させる攻撃（プロンプトインジェクション） | 高 | 入力の安全チェック＋番人による二重チェック。許可リストにない命令は無条件で拒否 |
| 安全な作業スペースからの脱出 | 高 | 最も厳格なサンドボックス技術を採用。定期的な安全性検査 |
| 誤った操作を自動で実行してしまう | 高 | 中リスク以上は必ず社長の承認を挟む。自動実行は低リスクのみ |

### 権限ルール（3段階で解放）

| 段階 | できること | 条件 | 期間の目安 |
|------|-----------|------|-----------|
| **第1段階** | 読み取りのみ（データの閲覧、検索） | Step C-3完了後 | 最初の2週間 |
| **第2段階** | 安全な書き込み（ファイル作成、レポート生成） | 第1段階で2週間問題なし＋社長承認 | 次の2週間 |
| **第3段階** | 外部操作（メール送信、API呼び出し等） | 社長が個別に許可した操作のみ | 社長判断 |

---

## Step D：マニュアル整理（元Phase 4）— ✅ 完了（PR #571〜#573）

### 何をするか（小学生向け説明）

ソウル君の「マニュアル（＝プログラムのコード）」が分厚くなりすぎているので、
Step A〜Cで不要になった部分を整理・削除して、見通しをよくします。

### いつやるか

Step A〜Cが安定してから。急ぐ必要はない。

### メリット

- バグ（＝不具合）が起きにくくなる
- 新しい機能を追加するのが楽になる
- システム全体の動きが速くなる

---

## Step E：外販準備（元Phase 5）

### 何をするか（小学生向け説明）

ソウル君を「他の会社にも使ってもらえる」形に整えます。
会社ごとに名前・性格・使える機能を変えられるようにします。

### いつやるか（Codexの指摘を反映）

~~Step A〜Dが完了し、自社で最低3ヶ月の安定稼働実績ができてから。~~

**修正：「3ヶ月」だけでなく、以下の安全性の基準を全て満たしてから。**

| 基準 | 説明 |
|------|------|
| 事故ゼロ期間 | 重大な事故（データ破損、情報漏洩）が3ヶ月間ゼロ |
| 監査ログ完備 | 全操作の記録が完全に残っていることを確認 |
| 緊急対応テスト済み | 「問題が起きたらどうするか」の訓練を実施済み |
| 誤操作率ゼロ | 番人が止めるべき操作を全て止められていることを確認 |

### 既に整っている強み

- マルチテナント（＝複数の会社のデータを安全に分ける仕組み）：完了済み
- 3層安全装置：稼働中
- 監査ログ（＝誰が何をしたかの記録）：稼働中
- テスト6,694件：品質チェック充実

### まだ必要なこと

| 必要なこと | 説明 |
|-----------|------|
| キャラクター設定機能 | 会社ごとにボットの名前・口調を変えられるようにする |
| 窓口の選択機能 | ChatWork、テレグラム、Slack、LINEから選べるようにする |
| 道具の選択機能 | 会社ごとに使える道具を選べるようにする |
| 料金プランの設計 | AI利用量に応じた課金の仕組み |
| 管理者向けの画面 | お客さんの管理者が自分で設定を変えられる画面 |

---

## 権限設計の全体像（カズさんの4つの要望を反映）

### 基本原則

**「鍵束は社長が持つ。社員は鍵を勝手に作れない。」**

### 要望1：全ての権限はまず社長が握る

| 操作の種類 | 社長の承認 |
|-----------|:-:|
| 新しい道具の追加 | 必須 |
| 新しい窓口の追加 | 必須 |
| 手足の権限拡大 | 必須 |
| スタッフへの機能開放 | 必須 |
| 権限レベルの変更 | 必須 |

### 要望2：スタッフ自身では機能の拡張ができない

- スタッフが使える機能は、社長が「これは使ってOK」と許可したものだけ
- 新しい道具や機能をスタッフが勝手に追加・変更することは不可能
- ただし「今ある機能を使う」ことは、権限レベルの範囲内でOK（Codexの指摘を反映）

### 要望3：機能の拡張要望は必ず社長に届く

- スタッフが「こんな機能がほしい」と言ったら、ソウル君がその要望を記録
- 記録された要望は「チケット（＝整理番号付きの依頼書）」としてデータベースに保存
- 社長は管理画面（＝ダッシュボード）でまとめて確認できる

### 要望4：「管理部に提案してみるね」→ 社長にDM

**スタッフとの会話の流れ：**

```
スタッフ：「ソウル君、Slackからも話しかけられるようにならない？」
ソウル君：「いいアイデアですね！管理部に提案してみますね。」
         ↓（裏側で自動的に）
         ① 要望をチケットとしてDBに保存
         ② 社長のChatWork個人DMに通知
            「[要望] 田中さんからSlack連携の要望がありました。
             詳細は管理画面で確認できます。」
         ③ 社長が管理画面で「承認」「却下」「保留」を選択
         ↓
スタッフへの後日フィードバック：
         「先日の提案について、検討の結果〇〇となりました」
```

### ボトルネック対策（3AIが指摘）

| 状況 | 対策 |
|------|------|
| 要望が大量に来た場合 | 週次でまとめて確認できるダッシュボードを用意 |
| 社長が忙しくて確認できない場合 | 1週間未確認の要望は自動リマインド |
| 緊急の要望の場合 | 「緊急」タグ付きでDMを即送信 |
| 社長が長期不在の場合 | 事前に指定した代理人が「中リスク」の承認のみ可能 |

### DM通知の安全策（Geminiの指摘を反映）

| リスク | 対策 |
|--------|------|
| AIが偽の緊急報告をでっち上げる可能性 | 1時間あたりの通知回数に上限を設定（例：最大5件/時間） |
| 要望が埋もれる可能性 | チケットのステータス管理。未対応チケットの週次レポート |

---

## 3AIレビューで反映した主な変更点

| # | 指摘元 | 指摘内容 | 対応 |
|---|--------|---------|------|
| 1 | **Codex** | 「安全の仕組みを道具追加より先に作れ」 | Step 0（安全の土台作り）を新規追加 |
| 2 | **Codex** | 「Step Cの期間が短すぎる」 | 3〜4週間 → 6〜10週間に修正 |
| 3 | **Gemini** | 「テスト期間が計画にない」 | 各Stepにテスト・動作確認期間を追加 |
| 4 | **Gemini** | 「プロンプトインジェクション対策がない」 | Step Cのリスク表に追加 |
| 5 | **Codex** | 「社長不在時のフローがない」 | Step 0に社長不在時ルールを追加 |
| 6 | **Codex** | 「緊急停止スイッチがない」 | Step 0に緊急停止ボタンを追加 |
| 7 | **Gemini** | 「Step Aの期間が短すぎる」 | 2〜3週間 → 4〜6週間に修正 |
| 8 | **Codex** | 「SaaS化の基準が曖昧」 | 「3ヶ月」から定量的な安全基準に変更 |
| 9 | **Gemini** | 「DM通知機能が悪用される可能性」 | 通知回数の上限設定を追加 |
| 10 | **Codex** | 「監査ログの強化が必要」 | Step 0に監査ログ強化を追加 |

---

## 完了報告：Step 0〜D 全て実装完了

### 実装済みの成果（2026-02-18時点）

| Step | 内容 | PR | 状態 |
|------|------|-----|------|
| Step 0 | 安全の土台（承認ゲート・監査ログ強化・緊急停止） | #551 | ✅ 完了 |
| Step A | 道具追加（Web検索・Googleカレンダー・Googleドライブ） | #552〜#557, #567〜#568 | ✅ 完了 |
| Step B | Telegram窓口（社長専用・トピック対応） | #555, #575〜#577 | ✅ 完了 |
| Step C | 手足（MCPコマンド実行・サンドボックス・Guardian強化） | #558〜#566 | ✅ 完了 |
| Step D | マニュアル整理（リファクタリング・不要コード削除） | #571〜#573 | ✅ 完了 |
| 追加 | 画像認識AI（Telegram・ChatWork両対応） | #579〜#583 | ✅ 完了 |
| 追加 | Cloud Run移行 | #509 | ✅ 完了 |
| Step E | 外販準備（SaaS化） | — | 🔲 未着手 |

### 次のステップ

Step Eに進むための条件（前述の安全基準）を満たしているか、社長の判断を仰ぐ段階です。

---

## 注意事項（3AI全員が強調）— 引き続き有効

1. **既存機能を壊さない** — ✅ Step 0〜Dの実装を通じて維持できている
2. **安全を先に作る** — ✅ Step 0で承認ゲート・監査ログ強化・緊急停止を先に実装した
3. **段階的に進める** — ✅ Step 0→A→B→C→Dの順番で段階的に実装した
4. **CLAUDE.mdの原則は全て維持** — ✅ 脳がすべて、番人、10の鉄則、全てそのまま
5. **3AI合議でレビュー必須** — ✅ 全PRでClaude・Codex・Geminiの3AIレビューを実施した
6. **社長の承認なしに進めない** — ✅ 各Stepで社長の承認を得てから実装した
7. **緊急停止は常に可能** — ✅ 環境変数によるフィーチャーフラグで個別機能の停止が可能
