# 設計書廃止ポリシー

**作成日:** 2026-01-30
**目的:** 不要になった設計書を安全に廃止し、設計書群を常に最適化された状態に保つ

---

## Document Contract（SoT宣言）

| 項目 | 内容 |
|------|------|
| **この文書の役割** | 設計書の廃止プロセスと基準を定義 |
| **書くこと** | 廃止基準、廃止手順、移行期間ルール、廃止記録 |
| **書かないこと** | 設計書の作成方法（→FEATURE_ADDITION_FRAMEWORK.md） |
| **SoT（この文書が正）** | 設計書廃止の全プロセス |
| **Owner** | Tech Lead（連絡先: #dev チャンネル） |
| **更新トリガー** | 廃止プロセス変更時、廃止実績追加時 |

---

## 1. なぜ設計書を廃止するか

### 1.1 廃止しないと何が起きるか

```
【廃止しない場合】
設計書A（古い）   設計書B（新しい）   設計書C（最新）
    ↓                 ↓                  ↓
  どれが正しい？ → 混乱 → 間違った設計を参照 → バグ発生
```

### 1.2 廃止の目的

| 目的 | 効果 |
|------|------|
| **混乱防止** | 「どの設計書を見ればいいか」が明確 |
| **保守コスト削減** | 古い設計書のメンテナンス不要 |
| **検索効率向上** | 関連ファイルが減り、検索結果がクリア |
| **新規参入者の学習効率** | 古い情報に惑わされない |

---

## 2. 廃止の基準

### 2.1 廃止すべき設計書

| # | 基準 | 具体例 |
|---|------|--------|
| 1 | **機能が完全に削除された** | 使われなくなったツールの設計書 |
| 2 | **別の設計書に統合された** | 分割されていた設計が1つにまとまった |
| 3 | **技術的に陳腐化した** | 使われなくなった技術の設計書 |
| 4 | **重複している** | 同じ内容が複数ファイルに存在 |
| 5 | **6ヶ月以上参照されていない** | git log で確認 |

### 2.2 廃止してはいけない設計書

| # | 基準 | 理由 |
|---|------|------|
| 1 | **SoT（Single Source of Truth）に指定されている** | 他の設計書が参照している |
| 2 | **現在アクティブに実装で使用中** | 実装の根拠となっている |
| 3 | **法的・監査目的で必要** | コンプライアンス要件 |
| 4 | **廃止後の代替がない** | 情報の空白が生まれる |

### 2.3 判断フローチャート

```
設計書の廃止を検討
        ↓
【Q1】その設計書はSoTか？
  → Yes → 廃止不可（統合の場合はSoT移行が先）
  → No → 次へ
        ↓
【Q2】現在の実装で使用されているか？
  → Yes → 廃止不可
  → No → 次へ
        ↓
【Q3】代替となる設計書はあるか？
  → No → 廃止不可（情報の空白防止）
  → Yes → 次へ
        ↓
【Q4】6ヶ月以内に参照されたか？
  → Yes → 「非推奨」に移行し様子見
  → No → 廃止手続きへ
```

---

## 3. 廃止のステータス

### 3.1 3段階のステータス

| ステータス | ファイル状態 | 期間 | 説明 |
|-----------|-------------|------|------|
| **Active（有効）** | 通常 | - | 現役の設計書 |
| **Deprecated（非推奨）** | 警告ヘッダー追加 | 3ヶ月 | 廃止予定、代替を使用推奨 |
| **Archived（廃止）** | `_archived/`に移動 | - | 参照のみ、編集禁止 |

### 3.2 ステータス遷移

```
Active → Deprecated → Archived
         ↓
     （問題発覚）
         ↓
       Active に戻す
```

---

## 4. 廃止手順

### 4.1 Step 1: 非推奨（Deprecated）への移行

**対象:** 廃止候補の設計書

**作業内容:**

1. **非推奨ヘッダーを追加**

```markdown
> ⚠️ **非推奨（Deprecated）**
>
> この設計書は **2026-04-30** に廃止予定です。
>
> **代替:** [新しい設計書へのリンク](./新しい設計書.md)
>
> **廃止理由:** [理由を記載]
>
> **移行方法:** [必要な場合のみ]
```

2. **DESIGN_COVERAGE_MATRIX.md を更新**
   - 該当行のステータスを「Deprecated」に変更

3. **PRで変更をマージ**
   - レビュアー: Tech Lead
   - 承認後にマージ

### 4.2 Step 2: 移行期間（3ヶ月）

**期間中の対応:**

| 項目 | 対応 |
|------|------|
| 参照されたら | 代替設計書への誘導を追加 |
| 問題が発覚したら | Active に戻す |
| 代替設計書に不足があったら | 代替を更新してから継続 |

**期間終了の条件:**

- [ ] 3ヶ月経過
- [ ] 代替設計書が完全に機能している
- [ ] 参照している箇所が全て更新済み

### 4.3 Step 3: 廃止（Archived）への移行

**作業内容:**

1. **ファイルを `docs/_archived/` に移動**

```bash
git mv docs/古い設計書.md docs/_archived/古い設計書.md
```

2. **廃止ヘッダーを更新**

```markdown
> 🗄️ **廃止済み（Archived）**
>
> この設計書は **2026-04-30** に廃止されました。
>
> **代替:** [新しい設計書へのリンク](../新しい設計書.md)
>
> **廃止理由:** [理由を記載]
>
> ⚠️ このファイルは参照専用です。編集しないでください。
```

3. **DESIGN_COVERAGE_MATRIX.md を更新**
   - 該当行を削除（または「Archived」セクションに移動）

4. **廃止記録を更新**（本ファイルのセクション6）

5. **PRで変更をマージ**

---

## 5. 特殊ケースの対応

### 5.1 SoT設計書の廃止

**SoT設計書は直接廃止できない。** 以下の手順が必要：

1. **新しいSoT設計書を作成**
2. **DESIGN_COVERAGE_MATRIX.md のSoT参照を更新**
3. **全ての参照元を新SoTに更新**
4. **旧SoT設計書を非推奨に移行**
5. **通常の廃止手順を実行**

### 5.2 複数設計書の統合による廃止

**統合時の手順:**

1. **統合先の設計書を作成/更新**
2. **統合元の全情報が含まれていることを確認**
3. **統合元を同時に非推奨に移行**
4. **DESIGN_COVERAGE_MATRIX.md を更新**

### 5.3 緊急廃止（セキュリティ問題等）

**通常の3ヶ月を待てない場合:**

1. **Tech Lead + CTO の承認を取得**
2. **即座にファイルを `_archived/` に移動**
3. **全ての参照箇所を緊急更新**
4. **事後報告として廃止記録を更新**

---

## 6. 廃止記録

### 6.1 廃止済み設計書一覧

| # | 旧ファイル | 廃止日 | 理由 | 代替 |
|---|-----------|--------|------|------|
| - | （まだなし） | - | - | - |

### 6.2 非推奨（廃止予定）設計書一覧

| # | ファイル | 非推奨開始日 | 廃止予定日 | 理由 | 代替 |
|---|---------|-------------|-----------|------|------|
| - | （まだなし） | - | - | - | - |

---

## 7. 廃止チェックリスト

### 非推奨への移行時

- [ ] 廃止基準（セクション2.1）に該当することを確認
- [ ] 廃止してはいけない基準（セクション2.2）に該当しないことを確認
- [ ] 代替設計書が存在することを確認
- [ ] 非推奨ヘッダーを追加
- [ ] DESIGN_COVERAGE_MATRIX.md を更新
- [ ] PRでレビュー・マージ

### 廃止への移行時

- [ ] 移行期間（3ヶ月）が経過したことを確認
- [ ] 代替設計書が完全に機能していることを確認
- [ ] 参照している箇所が全て更新済みであることを確認
- [ ] ファイルを `_archived/` に移動
- [ ] 廃止ヘッダーを更新
- [ ] DESIGN_COVERAGE_MATRIX.md を更新
- [ ] 廃止記録（セクション6）を更新
- [ ] PRでレビュー・マージ

---

## 8. _archived ディレクトリのルール

### 8.1 ディレクトリ構造

```
docs/
├── _archived/           # 廃止済み設計書
│   ├── README.md        # 廃止済みファイル一覧
│   └── [廃止されたファイル]
├── CLAUDE.md
├── [その他の有効な設計書]
└── ...
```

### 8.2 _archived/README.md テンプレート

```markdown
# 廃止済み設計書（Archived Documents）

このディレクトリには廃止された設計書が保管されています。

## ルール

- **参照専用**: 編集しないでください
- **検索除外推奨**: IDE/エディタの検索から除外設定を推奨
- **削除禁止**: 履歴として保持（法的・監査目的）

## 廃止済みファイル一覧

| ファイル | 廃止日 | 代替 |
|---------|--------|------|
| - | - | - |
```

### 8.3 保持期間

| 種類 | 保持期間 | 理由 |
|------|---------|------|
| 通常の設計書 | 2年 | 参照可能性 |
| セキュリティ関連 | 5年 | 監査対応 |
| 法的要件のあるもの | 永久 | コンプライアンス |

---

## 9. 関連ドキュメント

| ドキュメント | 参照内容 |
|-------------|---------|
| DESIGN_COVERAGE_MATRIX.md | SoT一覧、設計書ステータス |
| FEATURE_ADDITION_FRAMEWORK.md | 新規設計書の作成方法 |
| DOCUMENTATION_FRESHNESS_POLICY.md | 設計書の鮮度管理 |

---

## 更新履歴

| 日付 | 変更内容 |
|------|---------|
| 2026-01-30 | 初版作成 |

---

**このファイルについての質問は、Tech Leadに連絡してください。**
