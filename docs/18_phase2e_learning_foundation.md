# Phase 2E: å­¦ç¿’åŸºç›¤ï¼ˆLearning Foundationï¼‰

## è¨­è¨ˆæ›¸æƒ…å ±

| é …ç›® | å†…å®¹ |
|------|------|
| ãƒãƒ¼ã‚¸ãƒ§ãƒ³ | 1.1.0 |
| ä½œæˆæ—¥ | 2026-01-27 |
| æ›´æ–°æ—¥ | 2026-01-27 |
| ä½œæˆè€… | Claude Code |
| ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ | ãƒ€ãƒ–ãƒ«ãƒã‚§ãƒƒã‚¯å®Œäº† |
| å‰æPhase | Phase 2Dï¼ˆCEO Learningï¼‰å®Œäº† |
| æ¬¡Phase | Phase 2Fï¼ˆçµæœã‹ã‚‰ã®å­¦ç¿’ï¼‰ |

---

## 1. æ¦‚è¦

### 1.1 ã“ã®Phaseã®ç›®çš„

**ã€Œã‚«ã‚ºã•ã‚“ã«æ•™ãˆã¦ã‚‚ã‚‰ã£ãŸã‚‰ã€ã¡ã‚ƒã‚“ã¨è¦šãˆã¦æ¬¡ã‹ã‚‰ç›´ã™ã€**

ç¾åœ¨ã®ã‚½ã‚¦ãƒ«ãã‚“ã¯ã€é–“é•ã„ã‚’æŒ‡æ‘˜ã•ã‚Œã¦ã‚‚ã€Œã™ã¿ã¾ã›ã‚“ã‚¦ãƒ«ã€ã¨è¬ã‚‹ã ã‘ã§ã€
åŒã˜é–“é•ã„ã‚’ç¹°ã‚Šè¿”ã™ã€‚ã“ã‚Œã¯ã€Œå­¦ç¿’ã€ã§ã¯ãªãã€Œåå¿œã€ã«éããªã„ã€‚

Phase 2Eã§ã¯ã€æ˜ç¤ºçš„ãªãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ï¼ˆã€Œé•ã†ã‚ˆã€ã€Œã“ã†ã ã‚ˆã€ï¼‰ã‚’
å—ã‘å–ã‚Šã€è¨˜æ†¶ã—ã€æ¬¡å›ã‹ã‚‰é©ç”¨ã™ã‚‹ä»•çµ„ã¿ã‚’æ§‹ç¯‰ã™ã‚‹ã€‚

### 1.2 è§£æ±ºã™ã‚‹å•é¡Œ

| ç¾çŠ¶ã®å•é¡Œ | Phase 2Eå¾Œ |
|-----------|-----------|
| ã€Œé•ã†ã‚ˆã€ã¨è¨€ã‚ã‚Œã¦ã‚‚æ¬¡ã‚‚åŒã˜é–“é•ã„ | ä¸€åº¦æ•™ã‚ã£ãŸã‚‰äºŒåº¦ã¨é–“é•ãˆãªã„ |
| ä½•ã‚’è¦šãˆãŸã‹åˆ†ã‹ã‚‰ãªã„ | è¦šãˆãŸã“ã¨ã‚’ä¸€è¦§ã§ç¢ºèªã§ãã‚‹ |
| æ•™ãˆæ–¹ãŒåˆ†ã‹ã‚‰ãªã„ | è‡ªç„¶ãªä¼šè©±ã§æ•™ãˆã‚‰ã‚Œã‚‹ |
| èª°ãŒæ•™ãˆãŸã‹åˆ†ã‹ã‚‰ãªã„ | èª°ãŒã„ã¤æ•™ãˆãŸã‹è¨˜éŒ²ã•ã‚Œã‚‹ |
| CEOæ•™ãˆã¨çŸ›ç›¾ã™ã‚‹å¯èƒ½æ€§ | **CEOæ•™ãˆãŒå¸¸ã«å„ªå…ˆã•ã‚Œã‚‹** |

### 1.3 å¯¾å¿œã™ã‚‹èƒ½åŠ›é …ç›®

| # | èƒ½åŠ› | ç¾çŠ¶ | ç›®æ¨™ |
|---|------|------|------|
| 4-1 | æ˜ç¤ºçš„å­¦ç¿’ | âŒ | â—‹ |
| 4-2 | ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯å­¦ç¿’ | âŒ | â—‹ |
| 4-7 | å¿˜å´é˜²æ­¢ | âŒ | â—‹ |
| 4-8 | çŸ¥è­˜ã®æ›´æ–° | âŒ | â—‹ |

### 1.4 è¨­è¨ˆåŸå‰‡

1. **è‡ªç„¶ãªæ•™ãˆæ–¹**: ç‰¹åˆ¥ãªã‚³ãƒãƒ³ãƒ‰ãªã—ã§ã€ä¼šè©±ã®ä¸­ã§æ•™ãˆã‚‰ã‚Œã‚‹
2. **å³åº§ã®åæ˜ **: æ•™ãˆãŸç›´å¾Œã‹ã‚‰é©ç”¨ã•ã‚Œã‚‹
3. **æ°¸ç¶šçš„ãªè¨˜æ†¶**: ä¸€åº¦æ•™ãˆãŸã‚‰å¿˜ã‚Œãªã„ï¼ˆæ˜ç¤ºçš„ã«å‰Šé™¤ã—ãªã„é™ã‚Šï¼‰
4. **é€æ˜æ€§**: ä½•ã‚’è¦šãˆã¦ã„ã‚‹ã‹ã€ã„ã¤ã§ã‚‚ç¢ºèªã§ãã‚‹
5. **å®‰å…¨æ€§**: é–“é•ã£ãŸå­¦ç¿’ã¯ä¿®æ­£ãƒ»å‰Šé™¤ã§ãã‚‹
6. **CEOæ•™ãˆå„ªå…ˆ**: Phase 2Dã§è“„ç©ã—ãŸCEOæ•™ãˆã¨çŸ›ç›¾ã™ã‚‹å­¦ç¿’ã¯é©ç”¨ã•ã‚Œãªã„
7. **å°†æ¥æ‹¡å¼µæ€§**: Phase 2F-2Oã¸ã®æ¥ç¶šãƒã‚¤ãƒ³ãƒˆã‚’å‚™ãˆã‚‹

---

## 2. å­¦ç¿’ã®ç¨®é¡ã¨ç¯„å›²

### 2.1 å­¦ç¿’ã‚«ãƒ†ã‚´ãƒª

Phase 2Eã§å¯¾å¿œã™ã‚‹å­¦ç¿’ã‚«ãƒ†ã‚´ãƒªã‚’å®šç¾©ã™ã‚‹ã€‚

| ã‚«ãƒ†ã‚´ãƒª | èª¬æ˜ | ä¾‹ |
|---------|------|-----|
| `alias` | åˆ¥åãƒ»ç•¥ç§° | ã€Œéº»ç¾ã€=ã€Œæ¸¡éƒ¨éº»ç¾ã€ |
| `preference` | å¥½ã¿ãƒ»ã‚„ã‚Šæ–¹ | ã€Œå ±å‘Šã¯ç®‡æ¡æ›¸ãã§ã€ |
| `fact` | äº‹å®Ÿãƒ»æƒ…å ± | ã€ŒAãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®æ‹…å½“ã¯ç”°ä¸­ã€ |
| `rule` | ãƒ«ãƒ¼ãƒ«ãƒ»æ±ºã¾ã‚Š | ã€Œé‡‘æ›œã¯å®šä¾‹ä¼šè­°ãŒã‚ã‚‹ã€ |
| `correction` | é–“é•ã„ã®ä¿®æ­£ | ã€Œã‚¿ã‚¹ã‚¯ã®æœŸé™ã¯ç¿Œå–¶æ¥­æ—¥ã€ |
| `context` | æ–‡è„ˆãƒ»èƒŒæ™¯ | ã€Œä»Šæœˆã¯ç¹å¿™æœŸã€ |
| `relationship` | äººé–“é–¢ä¿‚ | ã€Œä½è—¤ã¨éˆ´æœ¨ã¯åŒæœŸã€ |
| `procedure` | æ‰‹é †ãƒ»ã‚„ã‚Šæ–¹ | ã€Œè«‹æ±‚æ›¸ã¯çµŒç†ã«å›ã™ã€ |

### 2.2 å­¦ç¿’ã®ã‚¹ã‚³ãƒ¼ãƒ—

å­¦ç¿’ã—ãŸå†…å®¹ã®é©ç”¨ç¯„å›²ã‚’å®šç¾©ã™ã‚‹ã€‚

| ã‚¹ã‚³ãƒ¼ãƒ— | èª¬æ˜ | ä¾‹ |
|---------|------|-----|
| `global` | å…¨å“¡ã«é©ç”¨ | ä¼šç¤¾ã®ãƒ«ãƒ¼ãƒ«ã€å…±é€šçŸ¥è­˜ |
| `user` | ç‰¹å®šãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã¿ | å€‹äººã®å¥½ã¿ã€ç•¥ç§° |
| `room` | ç‰¹å®šãƒ«ãƒ¼ãƒ ã®ã¿ | ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå›ºæœ‰ã®æƒ…å ± |
| `temporary` | æœŸé–“é™å®š | ã€Œä»Šæœˆã¯ã€‡ã€‡ã€ |

### 2.3 å­¦ç¿’ã®æ¨©é™ãƒ¬ãƒ™ãƒ«ï¼ˆPhase 2Dé€£æºï¼‰

å­¦ç¿’ã®æ•™ç¤ºè€…ã«ã‚ˆã‚‹å„ªå…ˆåº¦ã‚’å®šç¾©ã™ã‚‹ã€‚

| æ¨©é™ãƒ¬ãƒ™ãƒ« | èª¬æ˜ | å„ªå…ˆåº¦ | ä¸Šæ›¸ãå¯èƒ½ãªå¯¾è±¡ |
|-----------|------|--------|----------------|
| `ceo` | CEOã‹ã‚‰ã®æ•™ãˆï¼ˆPhase 2DçµŒç”±ï¼‰ | æœ€é«˜ | å…¨ã¦ |
| `manager` | ç®¡ç†è·ã‹ã‚‰ã®æ•™ãˆ | é«˜ | user, system |
| `user` | ä¸€èˆ¬ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‹ã‚‰ã®æ•™ãˆ | ä¸­ | system |
| `system` | ã‚·ã‚¹ãƒ†ãƒ è‡ªå‹•å­¦ç¿’ï¼ˆPhase 2Fï¼‰ | ä½ | ãªã— |

**é‡è¦**: `ceo`ãƒ¬ãƒ™ãƒ«ã®å­¦ç¿’ã¯Phase 2Dã®`ceo_teachings`ãƒ†ãƒ¼ãƒ–ãƒ«ã‹ã‚‰æ´¾ç”Ÿã—ã€
ä»–ã®å­¦ç¿’ã‚ˆã‚Šã‚‚å¸¸ã«å„ªå…ˆã•ã‚Œã‚‹ã€‚

### 2.4 å­¦ç¿’ã®å„ªå…ˆåº¦è§£æ±º

åŒã˜çŠ¶æ³ã§è¤‡æ•°ã®å­¦ç¿’ãŒè©²å½“ã™ã‚‹å ´åˆã®å„ªå…ˆé †ä½ã€‚

```
å„ªå…ˆåº¦ï¼ˆé«˜ã„é †ï¼‰:
1. CEOæ•™ãˆï¼ˆceo_teachingsï¼‰â† Phase 2Dã‹ã‚‰å‚ç…§
2. æ¨©é™ãƒ¬ãƒ™ãƒ«ãŒé«˜ã„å­¦ç¿’ï¼ˆauthority_levelï¼‰
3. ãƒ¦ãƒ¼ã‚¶ãƒ¼å›ºæœ‰ã®å­¦ç¿’ï¼ˆuser scopeï¼‰
4. ãƒ«ãƒ¼ãƒ å›ºæœ‰ã®å­¦ç¿’ï¼ˆroom scopeï¼‰
5. æœ€æ–°ã®å­¦ç¿’ï¼ˆnewer created_atï¼‰
6. ã‚°ãƒ­ãƒ¼ãƒãƒ«ãªå­¦ç¿’ï¼ˆglobal scopeï¼‰
```

---

## 3. ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯æ¤œå‡º

### 3.1 ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ãƒ‘ã‚¿ãƒ¼ãƒ³

ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ç™ºè¨€ã‹ã‚‰ã€Œã“ã‚Œã¯æ•™ãˆã¦ã„ã‚‹ã€ã“ã¨ã‚’æ¤œå‡ºã™ã‚‹ãƒ‘ã‚¿ãƒ¼ãƒ³ã€‚

#### 3.1.1 ç›´æ¥çš„ãªä¿®æ­£ãƒ‘ã‚¿ãƒ¼ãƒ³

```
ãƒ‘ã‚¿ãƒ¼ãƒ³1: ã€Œã€‡ã€‡ã¯â–³â–³ã ã‚ˆã€
ä¾‹: ã€Œéº»ç¾ã¯æ¸¡éƒ¨éº»ç¾ã®ã“ã¨ã ã‚ˆã€
æŠ½å‡º: trigger=ã€Œéº»ç¾ã€, correction=ã€Œæ¸¡éƒ¨éº»ç¾ã€, category=alias

ãƒ‘ã‚¿ãƒ¼ãƒ³2: ã€Œã€‡ã€‡ã˜ã‚ƒãªãã¦â–³â–³ã€
ä¾‹: ã€Œé€±å ±ã˜ã‚ƒãªãã¦æ—¥å ±ã ã‚ˆã€
æŠ½å‡º: wrong=ã€Œé€±å ±ã€, correct=ã€Œæ—¥å ±ã€, category=correction

ãƒ‘ã‚¿ãƒ¼ãƒ³3: ã€Œã€‡ã€‡ã®ã“ã¨ã¯â–³â–³ã£ã¦å‘¼ã‚“ã§ã€
ä¾‹: ã€Œæ¸¡éƒ¨éº»ç¾ã®ã“ã¨ã¯éº»ç¾ã£ã¦å‘¼ã‚“ã§ã€
æŠ½å‡º: target=ã€Œæ¸¡éƒ¨éº»ç¾ã€, alias=ã€Œéº»ç¾ã€, category=alias

ãƒ‘ã‚¿ãƒ¼ãƒ³4: ã€Œã€‡ã€‡=â–³â–³ã€ã€Œã€‡ã€‡ã‚¤ã‚³ãƒ¼ãƒ«â–³â–³ã€
ä¾‹: ã€ŒSS=ã‚½ã‚¦ãƒ«ã‚·ãƒ³ã‚¯ã‚¹ã€
æŠ½å‡º: alias=ã€ŒSSã€, full=ã€Œã‚½ã‚¦ãƒ«ã‚·ãƒ³ã‚¯ã‚¹ã€, category=alias
```

#### 3.1.2 ãƒ«ãƒ¼ãƒ«æ•™ç¤ºãƒ‘ã‚¿ãƒ¼ãƒ³

```
ãƒ‘ã‚¿ãƒ¼ãƒ³5: ã€Œã€‡ã€‡ã®æ™‚ã¯â–³â–³ã—ã¦ã€
ä¾‹: ã€Œæ€¥ãã®æ™‚ã¯å…ˆã«DMã§é€£çµ¡ã—ã¦ã€
æŠ½å‡º: condition=ã€Œæ€¥ãã®æ™‚ã€, action=ã€Œå…ˆã«DMã§é€£çµ¡ã€, category=rule

ãƒ‘ã‚¿ãƒ¼ãƒ³6: ã€Œã€‡ã€‡ã¯â–³â–³ãŒãƒ«ãƒ¼ãƒ«ã€
ä¾‹: ã€Œå ±å‘Šã¯æ¯æ—¥17æ™‚ãŒãƒ«ãƒ¼ãƒ«ã€
æŠ½å‡º: subject=ã€Œå ±å‘Šã€, rule=ã€Œæ¯æ—¥17æ™‚ã€, category=rule

ãƒ‘ã‚¿ãƒ¼ãƒ³7: ã€Œã€‡ã€‡ã—ãªã„ã§ã€ã€Œã€‡ã€‡ã¯ç¦æ­¢ã€
ä¾‹: ã€Œå‹æ‰‹ã«ã‚¿ã‚¹ã‚¯å‰Šé™¤ã—ãªã„ã§ã€
æŠ½å‡º: prohibited_action=ã€Œå‹æ‰‹ã«ã‚¿ã‚¹ã‚¯å‰Šé™¤ã€, category=rule
```

#### 3.1.3 å¥½ã¿æ•™ç¤ºãƒ‘ã‚¿ãƒ¼ãƒ³

```
ãƒ‘ã‚¿ãƒ¼ãƒ³8: ã€Œã€‡ã€‡ãŒå¥½ãã€ã€Œã€‡ã€‡ã®æ–¹ãŒã„ã„ã€
ä¾‹: ã€Œç®‡æ¡æ›¸ãã®æ–¹ãŒã„ã„ã€
æŠ½å‡º: preference=ã€Œç®‡æ¡æ›¸ãã€, category=preference

ãƒ‘ã‚¿ãƒ¼ãƒ³9: ã€Œã€‡ã€‡ã§ãŠé¡˜ã„ã€
ä¾‹: ã€Œæ•¬èªã§ãŠé¡˜ã„ã€
æŠ½å‡º: preference=ã€Œæ•¬èªã€, category=preference

ãƒ‘ã‚¿ãƒ¼ãƒ³10: ã€Œã„ã¤ã‚‚ã€‡ã€‡ã§ã€
ä¾‹: ã€Œã„ã¤ã‚‚è¦ç‚¹3ã¤ã§ã¾ã¨ã‚ã¦ã€
æŠ½å‡º: preference=ã€Œè¦ç‚¹3ã¤ã§ã¾ã¨ã‚ã‚‹ã€, category=preference
```

#### 3.1.4 äº‹å®Ÿæ•™ç¤ºãƒ‘ã‚¿ãƒ¼ãƒ³

```
ãƒ‘ã‚¿ãƒ¼ãƒ³11: ã€Œã€‡ã€‡ã¯â–³â–³ã€ï¼ˆäº‹å®Ÿã®é™³è¿°ï¼‰
ä¾‹: ã€ŒAãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®æ‹…å½“ã¯ç”°ä¸­ã•ã‚“ã€
æŠ½å‡º: subject=ã€ŒAãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®æ‹…å½“ã€, fact=ã€Œç”°ä¸­ã•ã‚“ã€, category=fact

ãƒ‘ã‚¿ãƒ¼ãƒ³12: ã€Œè¦šãˆã¦ãŠã„ã¦ã€ã€‡ã€‡ã€
ä¾‹: ã€Œè¦šãˆã¦ãŠã„ã¦ã€æ¥æœˆã‹ã‚‰æ–°ã‚ªãƒ•ã‚£ã‚¹ã€
æŠ½å‡º: fact=ã€Œæ¥æœˆã‹ã‚‰æ–°ã‚ªãƒ•ã‚£ã‚¹ã€, category=fact

ãƒ‘ã‚¿ãƒ¼ãƒ³13: ã€Œã€‡ã€‡ã ã‹ã‚‰è¦šãˆã¦ãŠã„ã¦ã€
ä¾‹: ã€Œå±±ç”°ã•ã‚“ã¯è‚²ä¼‘ä¸­ã ã‹ã‚‰è¦šãˆã¦ãŠã„ã¦ã€
æŠ½å‡º: fact=ã€Œå±±ç”°ã•ã‚“ã¯è‚²ä¼‘ä¸­ã€, category=fact
```

#### 3.1.5 æ–‡è„ˆä¾å­˜ãƒ‘ã‚¿ãƒ¼ãƒ³

```
ãƒ‘ã‚¿ãƒ¼ãƒ³14: ç›´å‰ã®é–“é•ã„ã¸ã®æŒ‡æ‘˜
ä¾‹:
  ã‚½ã‚¦ãƒ«ãã‚“: ã€Œç”°ä¸­ã•ã‚“ã«ã‚¿ã‚¹ã‚¯ã‚’ä½œæˆã—ãŸã‚¦ãƒ«ã€
  ãƒ¦ãƒ¼ã‚¶ãƒ¼: ã€Œç”°ä¸­ã˜ã‚ƒãªãã¦ä½è—¤ã€
æŠ½å‡º: previous_action=ã€Œç”°ä¸­ã•ã‚“ã«ã‚¿ã‚¹ã‚¯ã€, correction=ã€Œä½è—¤ã€

ãƒ‘ã‚¿ãƒ¼ãƒ³15: æš—é»™ã®ä¿®æ­£
ä¾‹:
  ã‚½ã‚¦ãƒ«ãã‚“: ã€Œæ˜æ—¥ã®ä¼šè­°ã¯10æ™‚ã§ã™ã‚¦ãƒ«ã€
  ãƒ¦ãƒ¼ã‚¶ãƒ¼: ã€Œ11æ™‚ã ã‚ˆã€
æŠ½å‡º: wrong=ã€Œ10æ™‚ã€, correct=ã€Œ11æ™‚ã€, context=ã€Œæ˜æ—¥ã®ä¼šè­°ã€
```

### 3.2 ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯æ¤œå‡ºãƒ•ãƒ­ãƒ¼

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯æ¤œå‡ºãƒ•ãƒ­ãƒ¼                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚   ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å—ä¿¡                                      â”‚
â”‚         â”‚                                                    â”‚
â”‚         â–¼                                                    â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                 â”‚
â”‚   â”‚ 1. ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒãƒƒãƒãƒ³ã‚°   â”‚                                 â”‚
â”‚   â”‚    15ç¨®ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã§æ¤œæŸ» â”‚                                 â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                 â”‚
â”‚               â”‚                                              â”‚
â”‚         ãƒãƒƒãƒã‚ã‚Š?                                           â”‚
â”‚         â”œâ”€ No â”€â”€â†’ é€šå¸¸å‡¦ç†ã¸                                â”‚
â”‚         â”‚                                                    â”‚
â”‚         â–¼ Yes                                                â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                 â”‚
â”‚   â”‚ 2. æ–‡è„ˆåˆ†æ            â”‚                                 â”‚
â”‚   â”‚    ç›´å‰ã®ä¼šè©±ã‚’ç¢ºèª    â”‚                                 â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                 â”‚
â”‚               â”‚                                              â”‚
â”‚         â–¼                                                    â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                 â”‚
â”‚   â”‚ 3. å­¦ç¿’å†…å®¹ã®æŠ½å‡º      â”‚                                 â”‚
â”‚   â”‚    ã‚«ãƒ†ã‚´ãƒªã€ã‚¹ã‚³ãƒ¼ãƒ—  â”‚                                 â”‚
â”‚   â”‚    ãƒˆãƒªã‚¬ãƒ¼ã€ä¿®æ­£å†…å®¹  â”‚                                 â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                 â”‚
â”‚               â”‚                                              â”‚
â”‚         â–¼                                                    â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                 â”‚
â”‚   â”‚ 4. CEOæ•™ãˆã¨ã®æ•´åˆæ€§   â”‚ â† â˜… Phase 2Dé€£æº               â”‚
â”‚   â”‚    çŸ›ç›¾ãŒãªã„ã‹ç¢ºèª    â”‚                                 â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                 â”‚
â”‚               â”‚                                              â”‚
â”‚         çŸ›ç›¾ã‚ã‚Š?                                             â”‚
â”‚         â”œâ”€ Yes â”€â”€â†’ CEOæ•™ãˆå„ªå…ˆã‚’é€šçŸ¥                        â”‚
â”‚         â”‚          ã€ŒCEOã®æ–¹é‡ã¨ç•°ãªã‚‹ãŸã‚è¦šãˆã‚‰ã‚Œãªã„ã‚¦ãƒ«ã€ â”‚
â”‚         â”‚                                                    â”‚
â”‚         â–¼ No                                                 â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                 â”‚
â”‚   â”‚ 5. ç¢ºä¿¡åº¦ã®ç®—å‡º        â”‚                                 â”‚
â”‚   â”‚    ãƒ‘ã‚¿ãƒ¼ãƒ³æ˜ç¢ºã•      â”‚                                 â”‚
â”‚   â”‚    æ–‡è„ˆã®ä¸€è‡´åº¦        â”‚                                 â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                 â”‚
â”‚               â”‚                                              â”‚
â”‚         ç¢ºä¿¡åº¦ â‰¥ 0.7?                                        â”‚
â”‚         â”œâ”€ No â”€â”€â†’ ç¢ºèªãƒ¢ãƒ¼ãƒ‰                                â”‚
â”‚         â”‚         ã€Œã€‡ã€‡ã¨è¦šãˆã¦ã„ã„ã§ã™ã‹ï¼Ÿã€               â”‚
â”‚         â”‚                                                    â”‚
â”‚         â–¼ Yes                                                â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                 â”‚
â”‚   â”‚ 6. æ—¢å­˜å­¦ç¿’ã¨ã®çŸ›ç›¾æ¤œå‡º â”‚ â† â˜… çŸ›ç›¾æ¤œå‡º                   â”‚
â”‚   â”‚    åŒã˜triggerã®å­¦ç¿’ã‚’ â”‚                                 â”‚
â”‚   â”‚    ç¢ºèªã—ã€çŸ›ç›¾ã‚’æ¤œå‡º  â”‚                                 â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                 â”‚
â”‚               â”‚                                              â”‚
â”‚         çŸ›ç›¾ã‚ã‚Š?                                             â”‚
â”‚         â”œâ”€ Yes â”€â”€â†’ æ—§å­¦ç¿’ã‚’ç„¡åŠ¹åŒ–ï¼ˆsuperseded_byè¨­å®šï¼‰      â”‚
â”‚         â”‚                                                    â”‚
â”‚         â–¼ No                                                 â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                 â”‚
â”‚   â”‚ 7. å­¦ç¿’ã®ä¿å­˜          â”‚                                 â”‚
â”‚   â”‚    DBã«è¨˜éŒ²            â”‚                                 â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                 â”‚
â”‚               â”‚                                              â”‚
â”‚         â–¼                                                    â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                 â”‚
â”‚   â”‚ 8. ç¢ºèªãƒ¡ãƒƒã‚»ãƒ¼ã‚¸      â”‚                                 â”‚
â”‚   â”‚    ã€Œè¦šãˆãŸã‚¦ãƒ«ï¼ã€    â”‚                                 â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                 â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.3 ç¢ºèªãƒ¢ãƒ¼ãƒ‰

ç¢ºä¿¡åº¦ãŒä½ã„å ´åˆã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ç¢ºèªã‚’æ±‚ã‚ã‚‹ã€‚

```
ç¢ºèªãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ä¾‹:

ã€åˆ¥åã®å ´åˆã€‘
ã€Œã€éº»ç¾ã€ã¨è¨€ã£ãŸã‚‰ã€æ¸¡éƒ¨éº»ç¾ã•ã‚“ã€ã®ã“ã¨ã ã¨è¦šãˆã¦ã„ã„ã‚¦ãƒ«ï¼Ÿã€

ã€ãƒ«ãƒ¼ãƒ«ã®å ´åˆã€‘
ã€Œã€æ€¥ãã®æ™‚ã¯å…ˆã«DMã§é€£çµ¡ã™ã‚‹ã€ã¨ã„ã†ãƒ«ãƒ¼ãƒ«ã‚’è¦šãˆã¦ã„ã„ã‚¦ãƒ«ï¼Ÿã€

ã€å¥½ã¿ã®å ´åˆã€‘
ã€Œã‚«ã‚ºã•ã‚“ã¯ã€ç®‡æ¡æ›¸ãã€ãŒãŠå¥½ã¿ã¨è¦šãˆã¦ã„ã„ã‚¦ãƒ«ï¼Ÿã€

ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®å›ç­”:
- ã€Œã†ã‚“ã€ã€Œãã†ã€ã€Œã¯ã„ã€ã€ŒOKã€â†’ å­¦ç¿’ã‚’ä¿å­˜
- ã€Œé•ã†ã€ã€Œã„ã‚„ã€ã€Œã¡ãŒã†ã€â†’ å­¦ç¿’ã‚’ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã€è©³ç´°ã‚’è³ªå•
```

### 3.4 CEOæ•™ãˆçŸ›ç›¾æ™‚ã®å¯¾å¿œ

Phase 2Dã®CEOæ•™ãˆã¨çŸ›ç›¾ã™ã‚‹å­¦ç¿’ã‚’æ¤œå‡ºã—ãŸå ´åˆï¼š

```
ã€CEOæ•™ãˆã¨çŸ›ç›¾ã™ã‚‹å ´åˆã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã€‘
ã€Œã”ã‚ã‚“ã‚¦ãƒ«ï¼ã‚½ã‚¦ãƒ«ã‚·ãƒ³ã‚¯ã‚¹ã¨ã—ã¦å¤§äº‹ã«ã—ã¦ã„ã‚‹ã“ã¨ã¨ç•°ãªã‚‹ãŸã‚ã€
 ã“ã®å†…å®¹ã¯è¦šãˆã‚‹ã“ã¨ãŒã§ããªã„ã‚¦ãƒ«ğŸº

 ã‚½ã‚¦ãƒ«ã‚·ãƒ³ã‚¯ã‚¹ã®ãƒ«ãƒ¼ãƒ«:
 ã€Œå ±å‘Šã¯æ¯æ—¥17æ™‚ã«è¡Œã†ã€

 ã‚«ã‚ºã•ã‚“ã«ç¢ºèªãŒå¿…è¦ãªå ´åˆã¯ã€ç®¡ç†éƒ¨ãƒãƒ£ãƒƒãƒˆã§ãŠçŸ¥ã‚‰ã›ã§ãã‚‹ã‚¦ãƒ«ã€
```

---

## 4. å­¦ç¿’ã®ä¿å­˜

### 4.1 ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«

#### 4.1.1 brain_learnings ãƒ†ãƒ¼ãƒ–ãƒ«

```sql
CREATE TABLE brain_learnings (
    -- è­˜åˆ¥æƒ…å ±
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    organization_id UUID NOT NULL,

    -- å­¦ç¿’å†…å®¹
    category VARCHAR(50) NOT NULL,
    -- 'alias', 'preference', 'fact', 'rule', 'correction',
    -- 'context', 'relationship', 'procedure'

    -- ãƒˆãƒªã‚¬ãƒ¼ï¼ˆã„ã¤é©ç”¨ã™ã‚‹ã‹ï¼‰
    trigger_type VARCHAR(50) NOT NULL,
    -- 'keyword', 'pattern', 'context', 'always'
    trigger_value TEXT NOT NULL,
    -- ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã€æ­£è¦è¡¨ç¾ãƒ‘ã‚¿ãƒ¼ãƒ³ã€æ–‡è„ˆæ¡ä»¶

    -- å­¦ç¿’å†…å®¹ã®è©³ç´°
    learned_content JSONB NOT NULL,
    learned_content_version INTEGER NOT NULL DEFAULT 1,
    -- {
    --   "type": "alias",
    --   "from": "éº»ç¾",
    --   "to": "æ¸¡éƒ¨éº»ç¾",
    --   "description": "éº»ç¾ã¯æ¸¡éƒ¨éº»ç¾ã®ç•¥ç§°"
    -- }

    -- ã‚¹ã‚³ãƒ¼ãƒ—
    scope VARCHAR(50) NOT NULL DEFAULT 'global',
    -- 'global', 'user', 'room', 'temporary'
    scope_target_id VARCHAR(100),
    -- user scope ã®å ´åˆ: account_id
    -- room scope ã®å ´åˆ: room_id

    -- â˜… æ¨©é™ãƒ¬ãƒ™ãƒ«ï¼ˆPhase 2Dé€£æºï¼‰
    authority_level VARCHAR(20) NOT NULL DEFAULT 'user',
    -- 'ceo', 'manager', 'user', 'system'
    related_ceo_teaching_id UUID,
    -- Phase 2D ceo_teachings ã¨ã®é–¢é€£

    -- æœ‰åŠ¹æœŸé–“ï¼ˆtemporary scopeã®å ´åˆï¼‰
    valid_from TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP,
    valid_until TIMESTAMP WITH TIME ZONE,

    -- æ•™ãˆãŸäºº
    taught_by_account_id VARCHAR(50) NOT NULL,
    taught_by_name VARCHAR(100),
    taught_in_room_id VARCHAR(50),

    -- å…ƒã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
    source_message TEXT,
    source_context JSONB,
    -- ç›´å‰ã®ä¼šè©±ãªã©

    -- æ¤œå‡ºæƒ…å ±
    detection_pattern VARCHAR(100),
    detection_confidence DECIMAL(3,2),

    -- é©ç”¨çŠ¶æ³
    is_active BOOLEAN DEFAULT true,
    applied_count INTEGER DEFAULT 0,
    last_applied_at TIMESTAMP WITH TIME ZONE,
    success_count INTEGER DEFAULT 0,
    failure_count INTEGER DEFAULT 0,

    -- ä¸Šæ›¸ãæƒ…å ±
    supersedes_id UUID REFERENCES brain_learnings(id),
    superseded_by_id UUID REFERENCES brain_learnings(id),

    -- â˜… Phase 2Gæº–å‚™: çŸ¥è­˜ã‚°ãƒ©ãƒ•
    related_learning_ids UUID[],
    relationship_type VARCHAR(50),
    -- 'implies', 'contradicts', 'extends', 'specializes'
    confidence_decay_rate DECIMAL(5,4) DEFAULT 0.0001,
    -- æ™‚é–“çµŒéã«ã‚ˆã‚‹ç¢ºä¿¡åº¦ä½ä¸‹ç‡

    -- â˜… Phase 2Hæº–å‚™: è‡ªå·±èªè­˜
    unknown_pattern TEXT,
    -- ã€Œåˆ†ã‹ã‚‰ãªã‹ã£ãŸã€ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’è¨˜éŒ²
    clarification_count INTEGER DEFAULT 0,
    -- ç¢ºèªã‚’æ±‚ã‚ãŸå›æ•°

    -- â˜… Phase 2Næº–å‚™: è‡ªå·±æœ€é©åŒ–
    effectiveness_score DECIMAL(3,2)
        CHECK (effectiveness_score IS NULL OR
               (effectiveness_score >= 0.00 AND effectiveness_score <= 1.00)),
    last_effectiveness_check TIMESTAMP WITH TIME ZONE,
    decision_impact VARCHAR(20),
    -- 'positive', 'negative', 'neutral'

    -- ç›£æŸ»
    classification VARCHAR(20) DEFAULT 'internal',
    created_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP
);

-- ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹
CREATE INDEX idx_learnings_org ON brain_learnings(organization_id);
CREATE INDEX idx_learnings_category ON brain_learnings(organization_id, category);
CREATE INDEX idx_learnings_trigger ON brain_learnings(trigger_type, trigger_value);
CREATE INDEX idx_learnings_scope ON brain_learnings(organization_id, scope, scope_target_id);
CREATE INDEX idx_learnings_active ON brain_learnings(organization_id, is_active)
    WHERE is_active = true;
CREATE INDEX idx_learnings_taught_by ON brain_learnings(taught_by_account_id);
CREATE INDEX idx_learnings_updated ON brain_learnings(updated_at DESC);
CREATE INDEX idx_learnings_authority ON brain_learnings(authority_level);
CREATE INDEX idx_learnings_ceo_teaching ON brain_learnings(related_ceo_teaching_id)
    WHERE related_ceo_teaching_id IS NOT NULL;

-- Phase 2Fæº–å‚™: æš—é»™ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯æ¤œå‡ºç”¨
CREATE INDEX idx_learnings_implicit ON brain_learnings(detection_pattern)
    WHERE detection_pattern LIKE 'implicit_%';

-- Phase 2Næº–å‚™: åŠ¹æœæ¸¬å®šç”¨
CREATE INDEX idx_learnings_effectiveness ON brain_learnings(effectiveness_score DESC)
    WHERE effectiveness_score IS NOT NULL;

-- çŸ›ç›¾æ¤œå‡ºç”¨ï¼ˆé«˜é€ŸåŒ–ï¼‰
CREATE INDEX idx_learnings_trigger_active ON brain_learnings(trigger_value, is_active)
    WHERE is_active = true;

-- ãƒˆãƒªã‚¬ãƒ¼ï¼ˆå…¨æ–‡æ¤œç´¢ç”¨ï¼‰
CREATE INDEX idx_learnings_content ON brain_learnings
    USING GIN(learned_content jsonb_path_ops);

-- CHECKåˆ¶ç´„
ALTER TABLE brain_learnings ADD CONSTRAINT chk_learnings_category
    CHECK (category IN ('alias', 'preference', 'fact', 'rule',
                        'correction', 'context', 'relationship', 'procedure'));

ALTER TABLE brain_learnings ADD CONSTRAINT chk_learnings_scope
    CHECK (scope IN ('global', 'user', 'room', 'temporary'));

ALTER TABLE brain_learnings ADD CONSTRAINT chk_learnings_trigger_type
    CHECK (trigger_type IN ('keyword', 'pattern', 'context', 'always'));

ALTER TABLE brain_learnings ADD CONSTRAINT chk_learnings_authority_level
    CHECK (authority_level IN ('ceo', 'manager', 'user', 'system'));

ALTER TABLE brain_learnings ADD CONSTRAINT chk_learnings_relationship_type
    CHECK (relationship_type IS NULL OR relationship_type IN
           ('implies', 'contradicts', 'extends', 'specializes'));

ALTER TABLE brain_learnings ADD CONSTRAINT chk_learnings_decision_impact
    CHECK (decision_impact IS NULL OR decision_impact IN
           ('positive', 'negative', 'neutral'));

COMMENT ON TABLE brain_learnings IS 'ã‚½ã‚¦ãƒ«ãã‚“ã®å­¦ç¿’å†…å®¹ï¼ˆPhase 2Eï¼‰';
```

#### 4.1.2 brain_learning_logs ãƒ†ãƒ¼ãƒ–ãƒ«

å­¦ç¿’ã®é©ç”¨ãƒ­ã‚°ã‚’è¨˜éŒ²ã™ã‚‹ã€‚

```sql
CREATE TABLE brain_learning_logs (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    organization_id UUID NOT NULL,
    learning_id UUID NOT NULL REFERENCES brain_learnings(id),
    learning_version INTEGER NOT NULL DEFAULT 1,

    -- é©ç”¨çŠ¶æ³
    applied_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP,
    applied_in_room_id VARCHAR(50),
    applied_for_account_id VARCHAR(50),

    -- ãƒˆãƒªã‚¬ãƒ¼æƒ…å ±
    trigger_message TEXT,
    trigger_context JSONB,
    context_hash VARCHAR(64),
    -- æ–‡è„ˆã®ä¸€æ„è­˜åˆ¥å­ï¼ˆé‡è¤‡æ¤œå‡ºç”¨ï¼‰

    -- çµæœ
    was_successful BOOLEAN,
    result_description TEXT,
    response_latency_ms INTEGER,
    -- å¿œç­”æ™‚é–“ï¼ˆæ€§èƒ½åˆ†æç”¨ï¼‰

    -- ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ï¼ˆã‚‚ã—ã‚ã‚Œã°ï¼‰
    feedback_received BOOLEAN DEFAULT false,
    feedback_positive BOOLEAN,
    feedback_message TEXT,
    user_feedback_at TIMESTAMP WITH TIME ZONE,

    -- ç›£æŸ»
    created_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP
);

CREATE INDEX idx_learning_logs_learning ON brain_learning_logs(learning_id);
CREATE INDEX idx_learning_logs_org ON brain_learning_logs(organization_id);
CREATE INDEX idx_learning_logs_applied ON brain_learning_logs(applied_at DESC);
CREATE INDEX idx_learning_logs_feedback ON brain_learning_logs(learning_id, feedback_received)
    WHERE feedback_received = true;
CREATE INDEX idx_learning_logs_context_hash ON brain_learning_logs(context_hash);

COMMENT ON TABLE brain_learning_logs IS 'å­¦ç¿’é©ç”¨ãƒ­ã‚°ï¼ˆPhase 2Eï¼‰';
```

### 4.2 learned_content ã®æ§‹é€ 

ã‚«ãƒ†ã‚´ãƒªã”ã¨ã®JSONBæ§‹é€ ã‚’å®šç¾©ã€‚

#### 4.2.1 aliasï¼ˆåˆ¥åï¼‰

```json
{
  "type": "alias",
  "from": "éº»ç¾",
  "to": "æ¸¡éƒ¨éº»ç¾",
  "bidirectional": false,
  "description": "éº»ç¾ã¯æ¸¡éƒ¨éº»ç¾ã®ç•¥ç§°"
}
```

#### 4.2.2 preferenceï¼ˆå¥½ã¿ï¼‰

```json
{
  "type": "preference",
  "subject": "å ±å‘Šå½¢å¼",
  "preference": "ç®‡æ¡æ›¸ã",
  "priority": "high",
  "description": "å ±å‘Šã¯ç®‡æ¡æ›¸ãã‚’å¥½ã‚€"
}
```

#### 4.2.3 factï¼ˆäº‹å®Ÿï¼‰

```json
{
  "type": "fact",
  "subject": "Aãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®æ‹…å½“",
  "value": "ç”°ä¸­ã•ã‚“",
  "confidence": "high",
  "source": "ã‚«ã‚ºã•ã‚“ã‹ã‚‰ã®ç›´æ¥æ•™ç¤º",
  "description": "Aãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®æ‹…å½“ã¯ç”°ä¸­ã•ã‚“"
}
```

#### 4.2.4 ruleï¼ˆãƒ«ãƒ¼ãƒ«ï¼‰

```json
{
  "type": "rule",
  "condition": "æ€¥ãã®æ™‚",
  "action": "å…ˆã«DMã§é€£çµ¡ã™ã‚‹",
  "priority": "high",
  "exceptions": [],
  "description": "æ€¥ãã®æ™‚ã¯å…ˆã«DMã§é€£çµ¡ã™ã‚‹ãƒ«ãƒ¼ãƒ«"
}
```

#### 4.2.5 correctionï¼ˆä¿®æ­£ï¼‰

```json
{
  "type": "correction",
  "wrong_pattern": "ã‚¿ã‚¹ã‚¯ã®æœŸé™ã‚’å½“æ—¥ã«è¨­å®š",
  "correct_pattern": "ã‚¿ã‚¹ã‚¯ã®æœŸé™ã‚’ç¿Œå–¶æ¥­æ—¥ã«è¨­å®š",
  "reason": "å½“æ—¥ã¯å³ã—ã™ãã‚‹",
  "description": "ã‚¿ã‚¹ã‚¯æœŸé™ã¯å½“æ—¥ã§ã¯ãªãç¿Œå–¶æ¥­æ—¥"
}
```

#### 4.2.6 contextï¼ˆæ–‡è„ˆï¼‰

```json
{
  "type": "context",
  "subject": "ä»Šæœˆ",
  "context": "ç¹å¿™æœŸ",
  "implications": ["æ®‹æ¥­ãŒå¤šã„", "æ€¥ãã®ä¾é ¼ãŒå¢—ãˆã‚‹"],
  "valid_until": "2026-01-31",
  "description": "ä»Šæœˆã¯ç¹å¿™æœŸ"
}
```

#### 4.2.7 relationshipï¼ˆé–¢ä¿‚ï¼‰

```json
{
  "type": "relationship",
  "person1": "ä½è—¤",
  "person2": "éˆ´æœ¨",
  "relationship": "åŒæœŸ",
  "notes": "ä»²ãŒè‰¯ã„",
  "description": "ä½è—¤ã¨éˆ´æœ¨ã¯åŒæœŸ"
}
```

#### 4.2.8 procedureï¼ˆæ‰‹é †ï¼‰

```json
{
  "type": "procedure",
  "task": "è«‹æ±‚æ›¸å‡¦ç†",
  "steps": [
    "1. å†…å®¹ç¢ºèª",
    "2. çµŒç†ã«å›ã™",
    "3. æ‰¿èªã‚’å¾…ã¤"
  ],
  "notes": "æ€¥ãã®å ´åˆã¯ç›´æ¥çµŒç†ã«å£°ã‚’ã‹ã‘ã‚‹",
  "description": "è«‹æ±‚æ›¸ã¯çµŒç†ã«å›ã™æ‰‹é †"
}
```

---

## 5. å­¦ç¿’ã®é©ç”¨

### 5.1 é©ç”¨ãƒ•ãƒ­ãƒ¼

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     å­¦ç¿’é©ç”¨ãƒ•ãƒ­ãƒ¼                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚   ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å‡¦ç†é–‹å§‹                                          â”‚
â”‚         â”‚                                                    â”‚
â”‚         â–¼                                                    â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                 â”‚
â”‚   â”‚ 0. CEOæ•™ãˆã®å‚ç…§       â”‚ â† â˜… Phase 2Dé€£æº              â”‚
â”‚   â”‚    ceo_teachingså‚ç…§   â”‚                                 â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                 â”‚
â”‚               â”‚                                              â”‚
â”‚         â–¼                                                    â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                 â”‚
â”‚   â”‚ 1. é–¢é€£å­¦ç¿’ã®æ¤œç´¢      â”‚                                 â”‚
â”‚   â”‚    - ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ãƒãƒƒãƒ  â”‚                                 â”‚
â”‚   â”‚    - ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒãƒƒãƒ    â”‚                                 â”‚
â”‚   â”‚    - æ–‡è„ˆãƒãƒƒãƒ        â”‚                                 â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                 â”‚
â”‚               â”‚                                              â”‚
â”‚         å­¦ç¿’ã‚ã‚Š?                                             â”‚
â”‚         â”œâ”€ No â”€â”€â†’ é€šå¸¸å‡¦ç†ã¸                                â”‚
â”‚         â”‚                                                    â”‚
â”‚         â–¼ Yes                                                â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                 â”‚
â”‚   â”‚ 2. CEOæ•™ãˆã¨ã®æ•´åˆæ€§   â”‚ â† â˜… çŸ›ç›¾ã™ã‚‹å­¦ç¿’ã‚’é™¤å¤–        â”‚
â”‚   â”‚    çŸ›ç›¾ã™ã‚‹å­¦ç¿’ã‚’é™¤å¤–  â”‚                                 â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                 â”‚
â”‚               â”‚                                              â”‚
â”‚         â–¼                                                    â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                 â”‚
â”‚   â”‚ 3. ã‚¹ã‚³ãƒ¼ãƒ—ç¢ºèª        â”‚                                 â”‚
â”‚   â”‚    - user/room/global â”‚                                 â”‚
â”‚   â”‚    - æœ‰åŠ¹æœŸé–“          â”‚                                 â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                 â”‚
â”‚               â”‚                                              â”‚
â”‚         é©ç”¨å¯èƒ½?                                             â”‚
â”‚         â”œâ”€ No â”€â”€â†’ é€šå¸¸å‡¦ç†ã¸                                â”‚
â”‚         â”‚                                                    â”‚
â”‚         â–¼ Yes                                                â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                 â”‚
â”‚   â”‚ 4. å„ªå…ˆåº¦è§£æ±º          â”‚                                 â”‚
â”‚   â”‚    è¤‡æ•°å­¦ç¿’ãŒã‚ã‚‹å ´åˆ  â”‚                                 â”‚
â”‚   â”‚    authority_levelé †  â”‚                                 â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                 â”‚
â”‚               â”‚                                              â”‚
â”‚         â–¼                                                    â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                 â”‚
â”‚   â”‚ 5. å­¦ç¿’ã®é©ç”¨          â”‚                                 â”‚
â”‚   â”‚    ã‚«ãƒ†ã‚´ãƒªåˆ¥ã®å‡¦ç†    â”‚                                 â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                 â”‚
â”‚               â”‚                                              â”‚
â”‚         â–¼                                                    â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                 â”‚
â”‚   â”‚ 6. é©ç”¨ãƒ­ã‚°ã®è¨˜éŒ²      â”‚                                 â”‚
â”‚   â”‚    - learning_id      â”‚                                 â”‚
â”‚   â”‚    - é©ç”¨çµæœ          â”‚                                 â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                 â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.2 ã‚«ãƒ†ã‚´ãƒªåˆ¥ã®é©ç”¨æ–¹æ³•

#### 5.2.1 aliasï¼ˆåˆ¥åï¼‰ã®é©ç”¨

```python
# ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å†…ã®ã€Œéº»ç¾ã€ã‚’è¦‹ã¤ã‘ãŸã‚‰
if "éº»ç¾" in message:
    # å­¦ç¿’ã‚’æ¤œç´¢
    learning = find_learning(trigger_value="éº»ç¾", category="alias")
    if learning:
        # å†…éƒ¨çš„ã«ã€Œæ¸¡éƒ¨éº»ç¾ã€ã¨ã—ã¦å‡¦ç†
        resolved_name = learning.learned_content["to"]  # "æ¸¡éƒ¨éº»ç¾"
        # ä»¥é™ã®å‡¦ç†ã§ã¯ resolved_name ã‚’ä½¿ç”¨
```

#### 5.2.2 preferenceï¼ˆå¥½ã¿ï¼‰ã®é©ç”¨

```python
# å ±å‘Šã‚’ç”Ÿæˆã™ã‚‹æ™‚
def generate_report(content, user_id):
    # ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®å¥½ã¿ã‚’æ¤œç´¢
    preference = find_learning(
        category="preference",
        scope="user",
        scope_target_id=user_id
    )
    if preference and preference.learned_content["subject"] == "å ±å‘Šå½¢å¼":
        format_style = preference.learned_content["preference"]
        # å¥½ã¿ã®å½¢å¼ã§å ±å‘Šã‚’ç”Ÿæˆ
        return format_report(content, style=format_style)
```

#### 5.2.3 ruleï¼ˆãƒ«ãƒ¼ãƒ«ï¼‰ã®é©ç”¨

```python
# ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œã™ã‚‹å‰ã«
def check_rules(action, context):
    # é–¢é€£ãƒ«ãƒ¼ãƒ«ã‚’æ¤œç´¢
    rules = find_learnings(category="rule")
    for rule in rules:
        condition = rule.learned_content["condition"]
        if matches_condition(context, condition):
            required_action = rule.learned_content["action"]
            # ãƒ«ãƒ¼ãƒ«ã«å¾“ã£ãŸè¡Œå‹•ã‚’è¿½åŠ 
            apply_rule(required_action)
```

#### 5.2.4 correctionï¼ˆä¿®æ­£ï¼‰ã®é©ç”¨

```python
# ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œã™ã‚‹å‰ã«
def apply_corrections(intended_action):
    # é–¢é€£ã™ã‚‹ä¿®æ­£ã‚’æ¤œç´¢
    corrections = find_learnings(category="correction")
    for correction in corrections:
        wrong_pattern = correction.learned_content["wrong_pattern"]
        if matches_pattern(intended_action, wrong_pattern):
            correct_pattern = correction.learned_content["correct_pattern"]
            # ä¿®æ­£å¾Œã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã«å¤‰æ›´
            return apply_correction(intended_action, correct_pattern)
    return intended_action
```

### 5.3 è„³ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã¨ã®çµ±åˆ

å­¦ç¿’å±¤ã¯ã€è„³ã®å‡¦ç†ãƒ•ãƒ­ãƒ¼ã®å„æ®µéšã§å‚ç…§ã•ã‚Œã‚‹ã€‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    SoulkunBrain                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚   0. CEOæ•™ãˆå‚ç…§ï¼ˆPhase 2Dï¼‰                                 â”‚
â”‚      â””â”€â”€ ceo_teachings ã‚’å¸¸ã«æœ€å„ªå…ˆã§å‚ç…§                    â”‚
â”‚                                                              â”‚
â”‚   1. ç†è§£å±¤ï¼ˆUnderstandingï¼‰                                  â”‚
â”‚      â””â”€â”€ aliaså­¦ç¿’ã‚’é©ç”¨ï¼ˆåå‰ã®è§£æ±ºï¼‰                        â”‚
â”‚      â””â”€â”€ contextå­¦ç¿’ã‚’å‚ç…§ï¼ˆèƒŒæ™¯ç†è§£ï¼‰                        â”‚
â”‚                                                              â”‚
â”‚   2. åˆ¤æ–­å±¤ï¼ˆDecisionï¼‰                                       â”‚
â”‚      â””â”€â”€ ruleå­¦ç¿’ã‚’é©ç”¨ï¼ˆãƒ«ãƒ¼ãƒ«ã«å¾“ã†ï¼‰                       â”‚
â”‚      â””â”€â”€ correctionå­¦ç¿’ã‚’é©ç”¨ï¼ˆé–“é•ã„ã‚’é¿ã‘ã‚‹ï¼‰               â”‚
â”‚      â””â”€â”€ â˜… CEOæ•™ãˆã¨çŸ›ç›¾ã—ãªã„ã“ã¨ã‚’ç¢ºèª                     â”‚
â”‚                                                              â”‚
â”‚   3. å®Ÿè¡Œå±¤ï¼ˆExecutionï¼‰                                      â”‚
â”‚      â””â”€â”€ procedureå­¦ç¿’ã‚’é©ç”¨ï¼ˆæ­£ã—ã„æ‰‹é †ï¼‰                    â”‚
â”‚      â””â”€â”€ preferenceå­¦ç¿’ã‚’é©ç”¨ï¼ˆå¥½ã¿ã«åˆã‚ã›ã‚‹ï¼‰               â”‚
â”‚                                                              â”‚
â”‚   4. å­¦ç¿’å±¤ï¼ˆLearningï¼‰                                       â”‚
â”‚      â””â”€â”€ æ–°ã—ã„å­¦ç¿’ã®æ¤œå‡ºãƒ»ä¿å­˜                               â”‚
â”‚      â””â”€â”€ é©ç”¨çµæœã®ãƒ­ã‚°è¨˜éŒ²                                   â”‚
â”‚      â””â”€â”€ â˜… CEOæ•™ãˆçŸ›ç›¾æ™‚ã¯å­¦ç¿’ã‚’æ‹’å¦                         â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 6. ç¢ºèªãƒ¡ãƒƒã‚»ãƒ¼ã‚¸

### 6.1 å­¦ç¿’æ™‚ã®ç¢ºèª

å­¦ç¿’ãŒæ¤œå‡ºã•ã‚ŒãŸæ™‚ã®ç¢ºèªãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã€‚

```
ã€åˆ¥åã‚’å­¦ç¿’ã—ãŸå ´åˆã€‘
ã€Œè¦šãˆãŸã‚¦ãƒ«ï¼ã€éº»ç¾ã€ã¨è¨€ã£ãŸã‚‰ã€æ¸¡éƒ¨éº»ç¾ã•ã‚“ã€ã®ã“ã¨ã§ã™ã­ã‚¦ãƒ«ğŸºã€

ã€ãƒ«ãƒ¼ãƒ«ã‚’å­¦ç¿’ã—ãŸå ´åˆã€‘
ã€Œè¦šãˆãŸã‚¦ãƒ«ï¼ã€æ€¥ãã®æ™‚ã¯å…ˆã«DMã§é€£çµ¡ã™ã‚‹ã€ãƒ«ãƒ¼ãƒ«ã§ã™ã­ã‚¦ãƒ«ğŸºã€

ã€å¥½ã¿ã‚’å­¦ç¿’ã—ãŸå ´åˆã€‘
ã€Œè¦šãˆãŸã‚¦ãƒ«ï¼ã‚«ã‚ºã•ã‚“ã¯ã€ç®‡æ¡æ›¸ãã€ãŒãŠå¥½ã¿ã§ã™ã­ã‚¦ãƒ«ğŸºã€

ã€äº‹å®Ÿã‚’å­¦ç¿’ã—ãŸå ´åˆã€‘
ã€Œè¦šãˆãŸã‚¦ãƒ«ï¼ã€Aãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®æ‹…å½“ã¯ç”°ä¸­ã•ã‚“ã€ã§ã™ã­ã‚¦ãƒ«ğŸºã€

ã€ä¿®æ­£ã‚’å­¦ç¿’ã—ãŸå ´åˆã€‘
ã€Œè¦šãˆãŸã‚¦ãƒ«ï¼ã€ã‚¿ã‚¹ã‚¯æœŸé™ã¯å½“æ—¥ã˜ã‚ƒãªãã¦ç¿Œå–¶æ¥­æ—¥ã€ã§ã™ã­ã‚¦ãƒ«ğŸº
 æ¬¡ã‹ã‚‰ãã†ã™ã‚‹ã‚¦ãƒ«ï¼ã€

ã€ç¢ºä¿¡åº¦ãŒä½ã„å ´åˆã€‘
ã€Œã€éº»ç¾ã€ã¯ã€æ¸¡éƒ¨éº»ç¾ã•ã‚“ã€ã®ã“ã¨ã ã¨è¦šãˆã¦ã„ã„ã‚¦ãƒ«ï¼Ÿã€

ã€CEOæ•™ãˆã¨çŸ›ç›¾ã™ã‚‹å ´åˆã€‘
ã€Œã”ã‚ã‚“ã‚¦ãƒ«ï¼ã‚½ã‚¦ãƒ«ã‚·ãƒ³ã‚¯ã‚¹ã¨ã—ã¦å¤§äº‹ã«ã—ã¦ã„ã‚‹ã“ã¨ã¨ç•°ãªã‚‹ãŸã‚ã€
 ã“ã®å†…å®¹ã¯è¦šãˆã‚‹ã“ã¨ãŒã§ããªã„ã‚¦ãƒ«ğŸºã€
```

### 6.2 é©ç”¨æ™‚ã®è¨€åŠ

å­¦ç¿’ã‚’é©ç”¨ã—ãŸæ™‚ã€å¿…è¦ã«å¿œã˜ã¦è¨€åŠã™ã‚‹ã€‚

```
ã€åˆå›é©ç”¨æ™‚ã€‘
ã€Œæ¸¡éƒ¨éº»ç¾ã•ã‚“ï¼ˆã‚«ã‚ºã•ã‚“ãŒã€éº»ç¾ã€ã¨å‘¼ã‚“ã§ã„ã‚‹æ–¹ï¼‰ã®ã‚¿ã‚¹ã‚¯ã§ã™ã­ã‚¦ãƒ«ã€

ã€ãƒ«ãƒ¼ãƒ«é©ç”¨æ™‚ã€‘
ã€Œæ€¥ãã¨ã®ã“ã¨ãªã®ã§ã€å…ˆã«DMã§ã‚‚é€£çµ¡ã—ãŸã‚¦ãƒ«ğŸºã€

ã€å¥½ã¿é©ç”¨æ™‚ã€‘
ï¼ˆå¥½ã¿ã«åˆã‚ã›ãŸå½¢å¼ã§å‡ºåŠ›ã™ã‚‹ãŒã€ç‰¹ã«è¨€åŠã—ãªã„ï¼‰

ã€ä¿®æ­£é©ç”¨æ™‚ã€‘
ã€Œã‚¿ã‚¹ã‚¯ã®æœŸé™ã¯ç¿Œå–¶æ¥­æ—¥ã«ã—ãŸã‚¦ãƒ«ğŸºã€
```

---

## 7. å­¦ç¿’ã®ç®¡ç†

### 7.1 å­¦ç¿’ä¸€è¦§ã®ç¢ºèª

ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒã€Œä½•ã‚’è¦šãˆã¦ã‚‹ï¼Ÿã€ã¨èã„ãŸæ™‚ã®å¿œç­”ã€‚

```
ã€ã‚³ãƒãƒ³ãƒ‰ä¾‹ã€‘
ã€Œã‚½ã‚¦ãƒ«ãã‚“ã€ä½•è¦šãˆã¦ã‚‹ï¼Ÿã€
ã€Œè¦šãˆã¦ã‚‹ã“ã¨æ•™ãˆã¦ã€
ã€Œå­¦ç¿’å†…å®¹ã‚’è¦‹ã›ã¦ã€

ã€å¿œç­”ä¾‹ã€‘
ã€Œã‚½ã‚¦ãƒ«ãã‚“ãŒè¦šãˆã¦ã„ã‚‹ã“ã¨ã‚¦ãƒ«ğŸº

ğŸ“ åˆ¥åï¼ˆ3ä»¶ï¼‰
ãƒ»éº»ç¾ â†’ æ¸¡éƒ¨éº»ç¾ã•ã‚“
ãƒ»SS â†’ ã‚½ã‚¦ãƒ«ã‚·ãƒ³ã‚¯ã‚¹
ãƒ»ã‚¿ã‚« â†’ é«˜æ©‹ã•ã‚“

ğŸ“‹ ãƒ«ãƒ¼ãƒ«ï¼ˆ2ä»¶ï¼‰
ãƒ»æ€¥ãã®æ™‚ã¯å…ˆã«DMã§é€£çµ¡ã™ã‚‹
ãƒ»é‡‘æ›œã¯å®šä¾‹ä¼šè­°ãŒã‚ã‚‹

ğŸ’¡ å¥½ã¿ï¼ˆã‚«ã‚ºã•ã‚“ï¼‰ï¼ˆ1ä»¶ï¼‰
ãƒ»å ±å‘Šã¯ç®‡æ¡æ›¸ãã§

ğŸ“Œ äº‹å®Ÿï¼ˆ2ä»¶ï¼‰
ãƒ»Aãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®æ‹…å½“ã¯ç”°ä¸­ã•ã‚“
ãƒ»ä»Šæœˆã¯ç¹å¿™æœŸ

å…¨éƒ¨ã§8ä»¶è¦šãˆã¦ã„ã‚‹ã‚¦ãƒ«ï¼
è©³ã—ãè¦‹ãŸã„é …ç›®ãŒã‚ã‚Œã°æ•™ãˆã¦ã‚¦ãƒ«ã€
```

### 7.2 å­¦ç¿’ã®å‰Šé™¤

é–“é•ã£ãŸå­¦ç¿’ã‚’å‰Šé™¤ã™ã‚‹ã€‚

```
ã€ã‚³ãƒãƒ³ãƒ‰ä¾‹ã€‘
ã€Œéº»ç¾ã®åˆ¥åã€å¿˜ã‚Œã¦ã€
ã€Œæ€¥ãDMã®ãƒ«ãƒ¼ãƒ«ã€å‰Šé™¤ã—ã¦ã€
ã€Œè¦šãˆã¦ã‚‹ã€‡ã€‡ã‚’å¿˜ã‚Œã¦ã€

ã€å¿œç­”ä¾‹ã€‘
ã€Œäº†è§£ã‚¦ãƒ«ï¼ã€éº»ç¾ â†’ æ¸¡éƒ¨éº»ç¾ã•ã‚“ã€ã‚’å¿˜ã‚ŒãŸã‚¦ãƒ«ğŸºã€

ã€ç¢ºèªãŒå¿…è¦ãªå ´åˆã€‘
ã€Œã©ã®å­¦ç¿’ã‚’å¿˜ã‚Œã‚Œã°ã„ã„ã‚¦ãƒ«ï¼Ÿ
1. éº»ç¾ â†’ æ¸¡éƒ¨éº»ç¾ã•ã‚“ï¼ˆåˆ¥åï¼‰
2. éº»ç¾ã¯çµŒç†æ‹…å½“ï¼ˆäº‹å®Ÿï¼‰
ç•ªå·ã§æ•™ãˆã¦ã‚¦ãƒ«ã€
```

### 7.3 å­¦ç¿’ã®ä¿®æ­£

æ—¢å­˜ã®å­¦ç¿’ã‚’ä¿®æ­£ã™ã‚‹ã€‚

```
ã€ã‚³ãƒãƒ³ãƒ‰ä¾‹ã€‘
ã€Œéº»ç¾ã¯æ¸¡éƒ¨éº»ç¾ã˜ã‚ƒãªãã¦ã€æµ…äº•éº»ç¾ã€
ã€Œã•ã£ãæ•™ãˆãŸã®é•ã£ãŸã€ã€‡ã€‡ã ã‚ˆã€

ã€å‡¦ç†ã€‘
1. æ—¢å­˜ã®å­¦ç¿’ã‚’ superseded_by ã§ç„¡åŠ¹åŒ–
2. æ–°ã—ã„å­¦ç¿’ã‚’ä½œæˆï¼ˆsupersedes ã§æ—§å­¦ç¿’ã‚’å‚ç…§ï¼‰

ã€å¿œç­”ä¾‹ã€‘
ã€Œä¿®æ­£ã—ãŸã‚¦ãƒ«ï¼ã€éº»ç¾ã€ã¯ã€æµ…äº•éº»ç¾ã•ã‚“ã€ã®ã“ã¨ã§ã™ã­ã‚¦ãƒ«ğŸº
 å‰ã«è¦šãˆãŸã€æ¸¡éƒ¨éº»ç¾ã•ã‚“ã€ã¯å¿˜ã‚ŒãŸã‚¦ãƒ«ã€
```

---

## 8. ã‚³ãƒ¼ãƒ‰è¨­è¨ˆ

### 8.1 ã‚¯ãƒ©ã‚¹æ§‹æˆ

```
lib/brain/
â”œâ”€â”€ learning/
â”‚   â”œâ”€â”€ __init__.py           # ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
â”‚   â”œâ”€â”€ detector.py           # ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯æ¤œå‡º
â”‚   â”œâ”€â”€ extractor.py          # å­¦ç¿’å†…å®¹ã®æŠ½å‡º
â”‚   â”œâ”€â”€ repository.py         # DBæ“ä½œ
â”‚   â”œâ”€â”€ applier.py            # å­¦ç¿’ã®é©ç”¨
â”‚   â”œâ”€â”€ manager.py            # å­¦ç¿’ã®ç®¡ç†ï¼ˆä¸€è¦§ã€å‰Šé™¤ã€ä¿®æ­£ï¼‰
â”‚   â”œâ”€â”€ patterns.py           # æ¤œå‡ºãƒ‘ã‚¿ãƒ¼ãƒ³å®šç¾©
â”‚   â”œâ”€â”€ conflict_detector.py  # â˜… çŸ›ç›¾æ¤œå‡ºï¼ˆæ–°è¦ï¼‰
â”‚   â”œâ”€â”€ authority_resolver.py # â˜… æ¨©é™ãƒ¬ãƒ™ãƒ«è§£æ±ºï¼ˆæ–°è¦ï¼‰
â”‚   â””â”€â”€ effectiveness_tracker.py  # â˜… åŠ¹æœè¿½è·¡ï¼ˆPhase 2Næº–å‚™ï¼‰
```

### 8.2 ä¸»è¦ã‚¯ãƒ©ã‚¹

#### 8.2.1 FeedbackDetector

```python
class FeedbackDetector:
    """ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã‚’æ¤œå‡ºã™ã‚‹ã‚¯ãƒ©ã‚¹"""

    def __init__(self, patterns: List[DetectionPattern]):
        self.patterns = patterns

    def detect(
        self,
        message: str,
        context: Optional[ConversationContext] = None
    ) -> Optional[FeedbackDetectionResult]:
        """
        ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‹ã‚‰ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã‚’æ¤œå‡ºã™ã‚‹

        Returns:
            FeedbackDetectionResult or None
        """
        for pattern in self.patterns:
            match = pattern.match(message, context)
            if match:
                return FeedbackDetectionResult(
                    pattern=pattern,
                    match=match,
                    confidence=self._calculate_confidence(match, context)
                )
        return None

    def _calculate_confidence(
        self,
        match: PatternMatch,
        context: Optional[ConversationContext]
    ) -> float:
        """ç¢ºä¿¡åº¦ã‚’è¨ˆç®—"""
        base_confidence = match.pattern.base_confidence

        # æ–‡è„ˆãŒä¸€è‡´ã™ã‚Œã°ç¢ºä¿¡åº¦ã‚¢ãƒƒãƒ—
        if context and self._context_supports(match, context):
            base_confidence += 0.1

        # ç›´å‰ã«é–“é•ã„ãŒã‚ã‚Œã°ç¢ºä¿¡åº¦ã‚¢ãƒƒãƒ—
        if context and context.has_recent_error:
            base_confidence += 0.1

        return min(base_confidence, 1.0)
```

#### 8.2.2 LearningExtractor

```python
class LearningExtractor:
    """å­¦ç¿’å†…å®¹ã‚’æŠ½å‡ºã™ã‚‹ã‚¯ãƒ©ã‚¹"""

    def extract(
        self,
        detection_result: FeedbackDetectionResult,
        message: str,
        context: Optional[ConversationContext] = None,
        taught_by_authority: str = 'user'
    ) -> Learning:
        """
        æ¤œå‡ºçµæœã‹ã‚‰å­¦ç¿’å†…å®¹ã‚’æŠ½å‡ºã™ã‚‹
        """
        category = self._determine_category(detection_result)

        return Learning(
            category=category,
            trigger_type=self._determine_trigger_type(detection_result),
            trigger_value=self._extract_trigger(detection_result, message),
            learned_content=self._extract_content(detection_result, message, category),
            scope=self._determine_scope(detection_result, context),
            authority_level=taught_by_authority,  # â˜… æ¨©é™ãƒ¬ãƒ™ãƒ«
            detection_pattern=detection_result.pattern.name,
            detection_confidence=detection_result.confidence,
            source_message=message,
            source_context=context.to_dict() if context else None
        )
```

#### 8.2.3 LearningRepository

```python
class LearningRepository:
    """å­¦ç¿’ã®DBæ“ä½œ"""

    def __init__(self, pool, organization_id: str):
        self.pool = pool
        self.organization_id = organization_id

    async def save(self, learning: Learning, taught_by: str) -> str:
        """å­¦ç¿’ã‚’ä¿å­˜"""
        query = """
            INSERT INTO brain_learnings (
                organization_id, category, trigger_type, trigger_value,
                learned_content, learned_content_version, scope, scope_target_id,
                authority_level, related_ceo_teaching_id,
                taught_by_account_id, source_message, source_context,
                detection_pattern, detection_confidence
            ) VALUES (
                :org_id, :category, :trigger_type, :trigger_value,
                :learned_content, :learned_content_version, :scope, :scope_target_id,
                :authority_level, :related_ceo_teaching_id,
                :taught_by, :source_message, :source_context,
                :detection_pattern, :detection_confidence
            ) RETURNING id
        """
        # ... å®Ÿè£…

    async def find_applicable(
        self,
        message: str,
        user_id: str,
        room_id: str
    ) -> List[Learning]:
        """é©ç”¨å¯èƒ½ãªå­¦ç¿’ã‚’æ¤œç´¢ï¼ˆauthority_levelé †ï¼‰"""
        query = """
            SELECT * FROM brain_learnings
            WHERE organization_id = :org_id
              AND is_active = true
              AND (valid_until IS NULL OR valid_until > CURRENT_TIMESTAMP)
              AND (
                  scope = 'global'
                  OR (scope = 'user' AND scope_target_id = :user_id)
                  OR (scope = 'room' AND scope_target_id = :room_id)
              )
            ORDER BY
                CASE authority_level
                    WHEN 'ceo' THEN 1
                    WHEN 'manager' THEN 2
                    WHEN 'user' THEN 3
                    ELSE 4
                END,
                CASE scope
                    WHEN 'user' THEN 1
                    WHEN 'room' THEN 2
                    ELSE 3
                END,
                created_at DESC
        """
        # ... å®Ÿè£…

    async def deactivate(self, learning_id: str, superseded_by: str = None):
        """å­¦ç¿’ã‚’ç„¡åŠ¹åŒ–"""
        # ... å®Ÿè£…
```

#### 8.2.4 LearningApplier

```python
class LearningApplier:
    """å­¦ç¿’ã‚’é©ç”¨ã™ã‚‹ã‚¯ãƒ©ã‚¹"""

    def __init__(
        self,
        repository: LearningRepository,
        ceo_teaching_repository: CEOTeachingRepository  # â˜… Phase 2Dé€£æº
    ):
        self.repository = repository
        self.ceo_teaching_repository = ceo_teaching_repository

    async def apply_to_understanding(
        self,
        message: str,
        user_id: str,
        room_id: str
    ) -> Tuple[str, List[AppliedLearning]]:
        """
        ç†è§£å±¤ã§ã®å­¦ç¿’é©ç”¨
        - alias: åå‰ã®è§£æ±º
        - context: èƒŒæ™¯æƒ…å ±ã®è¿½åŠ 
        """
        # â˜… ã¾ãšCEOæ•™ãˆã‚’å–å¾—
        ceo_teachings = await self.ceo_teaching_repository.get_relevant(
            message, self.repository.organization_id
        )

        # å­¦ç¿’ã‚’å–å¾—
        learnings = await self.repository.find_applicable(
            message, user_id, room_id
        )

        # â˜… CEOæ•™ãˆã¨çŸ›ç›¾ã™ã‚‹å­¦ç¿’ã‚’é™¤å¤–
        learnings = self._filter_conflicting_with_ceo(learnings, ceo_teachings)

        applied = []
        resolved_message = message

        for learning in learnings:
            if learning.category == 'alias':
                resolved_message = self._apply_alias(
                    resolved_message, learning
                )
                applied.append(AppliedLearning(learning, 'alias_resolved'))

        return resolved_message, applied

    def _filter_conflicting_with_ceo(
        self,
        learnings: List[Learning],
        ceo_teachings: List[CEOTeaching]
    ) -> List[Learning]:
        """CEOæ•™ãˆã¨çŸ›ç›¾ã™ã‚‹å­¦ç¿’ã‚’é™¤å¤–"""
        if not ceo_teachings:
            return learnings

        filtered = []
        for learning in learnings:
            is_conflicting = False
            for teaching in ceo_teachings:
                if self._conflicts_with(learning, teaching):
                    is_conflicting = True
                    break
            if not is_conflicting:
                filtered.append(learning)
        return filtered

    async def apply_to_decision(
        self,
        decision: Decision,
        context: BrainContext
    ) -> Tuple[Decision, List[AppliedLearning]]:
        """
        åˆ¤æ–­å±¤ã§ã®å­¦ç¿’é©ç”¨
        - rule: ãƒ«ãƒ¼ãƒ«ã®é©ç”¨
        - correction: ä¿®æ­£ã®é©ç”¨
        """
        # ... å®Ÿè£…
```

#### 8.2.5 LearningManager

```python
class LearningManager:
    """å­¦ç¿’ã®ç®¡ç†ï¼ˆä¸€è¦§ã€å‰Šé™¤ã€ä¿®æ­£ï¼‰"""

    def __init__(self, repository: LearningRepository):
        self.repository = repository

    async def list_learnings(
        self,
        category: Optional[str] = None,
        scope: Optional[str] = None
    ) -> List[Learning]:
        """å­¦ç¿’ä¸€è¦§ã‚’å–å¾—"""
        # ... å®Ÿè£…

    async def delete_learning(self, learning_id: str) -> bool:
        """å­¦ç¿’ã‚’å‰Šé™¤"""
        # ... å®Ÿè£…

    async def update_learning(
        self,
        learning_id: str,
        new_content: dict
    ) -> Learning:
        """å­¦ç¿’ã‚’æ›´æ–°ï¼ˆæ—§å­¦ç¿’ã‚’ç„¡åŠ¹åŒ–ã—æ–°å­¦ç¿’ã‚’ä½œæˆï¼‰"""
        # ... å®Ÿè£…

    async def format_list_for_display(
        self,
        learnings: List[Learning]
    ) -> str:
        """è¡¨ç¤ºç”¨ã«ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ"""
        # ... å®Ÿè£…
```

#### 8.2.6 ConflictDetectorï¼ˆæ–°è¦ï¼‰

```python
class ConflictDetector:
    """å­¦ç¿’é–“ã®çŸ›ç›¾ã‚’æ¤œå‡ºã™ã‚‹ã‚¯ãƒ©ã‚¹"""

    def __init__(self, repository: LearningRepository):
        self.repository = repository

    async def detect_conflicts(
        self,
        new_learning: Learning,
        existing_learnings: List[Learning] = None
    ) -> List[ConflictInfo]:
        """
        æ–°ã—ã„å­¦ç¿’ãŒæ—¢å­˜ã®å­¦ç¿’ã¨çŸ›ç›¾ã™ã‚‹ã‹ã‚’æ¤œå‡º

        çŸ›ç›¾ãƒ‘ã‚¿ãƒ¼ãƒ³:
        1. åŒã˜trigger_valueã§ç•°ãªã‚‹learned_content
        2. categoryãŒcorrectionã§ã€åŒã˜wrong_patternã«ç•°ãªã‚‹correct_pattern
        3. ruleã‚«ãƒ†ã‚´ãƒªã§ã€åŒã˜conditionã«ç•°ãªã‚‹action
        """
        if existing_learnings is None:
            existing_learnings = await self.repository.find_by_trigger(
                new_learning.trigger_value
            )

        conflicts = []
        for existing in existing_learnings:
            if self._is_conflicting(new_learning, existing):
                conflicts.append(ConflictInfo(
                    new_learning=new_learning,
                    existing_learning=existing,
                    conflict_type=self._determine_conflict_type(new_learning, existing),
                    resolution_suggestion=self._suggest_resolution(new_learning, existing)
                ))
        return conflicts

    async def resolve_conflict(
        self,
        conflict: ConflictInfo,
        resolution_strategy: str = 'newer_wins'
    ) -> Resolution:
        """
        çŸ›ç›¾ã‚’è§£æ±º

        æˆ¦ç•¥:
        - newer_wins: æ–°ã—ã„å­¦ç¿’ã‚’å„ªå…ˆï¼ˆæ—§å­¦ç¿’ã‚’supersedeï¼‰
        - higher_authority: authority_levelãŒé«˜ã„æ–¹ã‚’å„ªå…ˆ
        - confirm_user: ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ç¢ºèª
        """
        if resolution_strategy == 'newer_wins':
            # æ—§å­¦ç¿’ã‚’ç„¡åŠ¹åŒ–
            await self.repository.deactivate(
                conflict.existing_learning.id,
                superseded_by=conflict.new_learning.id
            )
            return Resolution(
                action='superseded',
                kept_learning=conflict.new_learning,
                removed_learning=conflict.existing_learning
            )
        elif resolution_strategy == 'higher_authority':
            if conflict.new_learning.authority_level_priority > \
               conflict.existing_learning.authority_level_priority:
                # æ–°å­¦ç¿’ãŒé«˜æ¨©é™ãªã®ã§æ—§ã‚’ç„¡åŠ¹åŒ–
                await self.repository.deactivate(
                    conflict.existing_learning.id,
                    superseded_by=conflict.new_learning.id
                )
                return Resolution(action='superseded', ...)
            else:
                # æ—§å­¦ç¿’ãŒé«˜æ¨©é™ãªã®ã§æ–°å­¦ç¿’ã‚’æ‹’å¦
                return Resolution(action='rejected', ...)
        else:
            return Resolution(action='needs_confirmation', ...)

    def _is_conflicting(self, new: Learning, existing: Learning) -> bool:
        """2ã¤ã®å­¦ç¿’ãŒçŸ›ç›¾ã™ã‚‹ã‹ã‚’åˆ¤å®š"""
        # åŒã˜ã‚«ãƒ†ã‚´ãƒªã§åŒã˜ãƒˆãƒªã‚¬ãƒ¼ã ãŒå†…å®¹ãŒç•°ãªã‚‹
        if new.category != existing.category:
            return False
        if new.trigger_value != existing.trigger_value:
            return False
        return new.learned_content != existing.learned_content
```

#### 8.2.7 AuthorityResolverï¼ˆæ–°è¦ï¼‰

```python
class AuthorityResolver:
    """æ¨©é™ãƒ¬ãƒ™ãƒ«è§£æ±ºã‚¯ãƒ©ã‚¹"""

    AUTHORITY_PRIORITY = {
        'ceo': 1,
        'manager': 2,
        'user': 3,
        'system': 4
    }

    def get_priority(self, authority_level: str) -> int:
        """æ¨©é™ãƒ¬ãƒ™ãƒ«ã®å„ªå…ˆåº¦ã‚’å–å¾—ï¼ˆæ•°å­—ãŒå°ã•ã„ã»ã©é«˜å„ªå…ˆï¼‰"""
        return self.AUTHORITY_PRIORITY.get(authority_level, 5)

    def can_override(self, new_authority: str, existing_authority: str) -> bool:
        """æ–°ã—ã„æ¨©é™ãŒæ—¢å­˜ã®æ¨©é™ã‚’ä¸Šæ›¸ãã§ãã‚‹ã‹ã‚’åˆ¤å®š"""
        return self.get_priority(new_authority) <= self.get_priority(existing_authority)

    def determine_authority_from_account(
        self,
        account_id: str,
        organization_id: str,
        pool
    ) -> str:
        """ã‚¢ã‚«ã‚¦ãƒ³ãƒˆIDã‹ã‚‰æ¨©é™ãƒ¬ãƒ™ãƒ«ã‚’æ±ºå®š"""
        # CEOã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆIDã‹ã©ã†ã‹ã‚’ç¢ºèª
        # ç®¡ç†è€…ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’å‚ç…§ã—ã¦åˆ¤å®š
        # ... å®Ÿè£…
```

#### 8.2.8 EffectivenessTrackerï¼ˆPhase 2Næº–å‚™ï¼‰

```python
class EffectivenessTracker:
    """å­¦ç¿’åŠ¹æœè¿½è·¡ã‚¯ãƒ©ã‚¹ï¼ˆPhase 2Næº–å‚™ï¼‰"""

    def __init__(self, repository: LearningRepository):
        self.repository = repository

    async def record_application_result(
        self,
        learning_id: str,
        was_successful: bool,
        feedback_positive: Optional[bool] = None
    ):
        """å­¦ç¿’é©ç”¨çµæœã‚’è¨˜éŒ²"""
        # brain_learning_logsã«è¨˜éŒ²
        # success_count / failure_count ã‚’æ›´æ–°
        pass

    async def calculate_effectiveness(
        self,
        learning_id: str
    ) -> float:
        """å­¦ç¿’ã®åŠ¹æœã‚¹ã‚³ã‚¢ã‚’è¨ˆç®—ï¼ˆ0.0-1.0ï¼‰"""
        # æˆåŠŸç‡ã€ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã€æœ€è¿‘ã®ä½¿ç”¨çŠ¶æ³ã‹ã‚‰è¨ˆç®—
        # effectiveness_score ã‚’æ›´æ–°
        pass

    async def get_underperforming_learnings(
        self,
        threshold: float = 0.5
    ) -> List[Learning]:
        """åŠ¹æœã®ä½ã„å­¦ç¿’ã‚’å–å¾—"""
        pass

    async def suggest_improvements(
        self,
        learning: Learning
    ) -> List[ImprovementSuggestion]:
        """å­¦ç¿’ã®æ”¹å–„ææ¡ˆã‚’ç”Ÿæˆï¼ˆPhase 2Nç”¨ï¼‰"""
        pass
```

### 8.3 core.py ã¸ã®çµ±åˆ

```python
# lib/brain/core.py

class SoulkunBrain:
    def __init__(self, ...):
        # æ—¢å­˜ã®åˆæœŸåŒ–...

        # Phase 2E: å­¦ç¿’åŸºç›¤
        self.feedback_detector = FeedbackDetector(DETECTION_PATTERNS)
        self.learning_extractor = LearningExtractor()
        self.learning_repository = LearningRepository(pool, org_id)
        self.conflict_detector = ConflictDetector(self.learning_repository)
        self.authority_resolver = AuthorityResolver()
        self.learning_applier = LearningApplier(
            self.learning_repository,
            self.ceo_teaching_repository  # Phase 2D
        )
        self.learning_manager = LearningManager(self.learning_repository)
        self.effectiveness_tracker = EffectivenessTracker(self.learning_repository)

    async def process_message(self, message, room_id, account_id, sender_name):
        # 1. ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯æ¤œå‡º
        feedback = self.feedback_detector.detect(
            message,
            self._get_conversation_context(room_id)
        )

        if feedback:
            # ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ãŒæ¤œå‡ºã•ã‚ŒãŸå ´åˆ
            return await self._handle_feedback(
                feedback, message, room_id, account_id, sender_name
            )

        # 2. é€šå¸¸å‡¦ç†ï¼ˆå­¦ç¿’ã‚’é©ç”¨ã—ãªãŒã‚‰ï¼‰
        # 2.1 ç†è§£å±¤ã§å­¦ç¿’é©ç”¨
        resolved_message, applied_in_understanding = \
            await self.learning_applier.apply_to_understanding(
                message, account_id, room_id
            )

        # 2.2 ç†è§£
        understanding = await self._understand(resolved_message, context)

        # 2.3 åˆ¤æ–­å±¤ã§å­¦ç¿’é©ç”¨
        decision, applied_in_decision = \
            await self.learning_applier.apply_to_decision(
                self._decide(understanding, context),
                context
            )

        # 2.4 å®Ÿè¡Œ
        result = await self._execute(decision)

        # 2.5 é©ç”¨ãƒ­ã‚°è¨˜éŒ² + åŠ¹æœè¿½è·¡
        await self._log_applied_learnings(
            applied_in_understanding + applied_in_decision
        )

        return result

    async def _handle_feedback(self, feedback, message, room_id, account_id, sender_name):
        """ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã‚’å‡¦ç†"""
        # æ¨©é™ãƒ¬ãƒ™ãƒ«ã‚’æ±ºå®š
        authority_level = self.authority_resolver.determine_authority_from_account(
            account_id, self.org_id, self.pool
        )

        # å­¦ç¿’å†…å®¹ã‚’æŠ½å‡º
        learning = self.learning_extractor.extract(
            feedback, message,
            self._get_conversation_context(room_id),
            taught_by_authority=authority_level
        )

        # â˜… CEOæ•™ãˆã¨ã®æ•´åˆæ€§ãƒã‚§ãƒƒã‚¯
        ceo_teachings = await self.ceo_teaching_repository.get_relevant(
            message, self.org_id
        )
        ceo_conflict = self._check_ceo_conflict(learning, ceo_teachings)
        if ceo_conflict:
            return BrainResponse(
                message=self._format_ceo_conflict_message(ceo_conflict),
                action_taken="learning_rejected_ceo_conflict"
            )

        # â˜… æ—¢å­˜å­¦ç¿’ã¨ã®çŸ›ç›¾ãƒã‚§ãƒƒã‚¯
        conflicts = await self.conflict_detector.detect_conflicts(learning)
        if conflicts:
            # çŸ›ç›¾ãŒã‚ã‚‹å ´åˆã¯è‡ªå‹•è§£æ±ºï¼ˆnewer_winsï¼‰
            for conflict in conflicts:
                await self.conflict_detector.resolve_conflict(
                    conflict,
                    resolution_strategy='newer_wins'
                )

        if feedback.confidence >= 0.7:
            # ç¢ºä¿¡åº¦ãŒé«˜ã„ï¼šç›´æ¥å­¦ç¿’
            await self.learning_repository.save(learning, account_id)

            return BrainResponse(
                message=self._format_learning_confirmation(learning),
                action_taken="learning_saved"
            )
        else:
            # ç¢ºä¿¡åº¦ãŒä½ã„ï¼šç¢ºèªãƒ¢ãƒ¼ãƒ‰
            return BrainResponse(
                message=self._format_learning_question(feedback),
                action_taken="learning_confirmation_requested",
                requires_response=True
            )
```

---

## 9. ãƒ†ã‚¹ãƒˆè¨ˆç”»

### 9.1 ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆ

```python
# tests/test_learning_detector.py

class TestFeedbackDetector:
    """ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯æ¤œå‡ºã®ãƒ†ã‚¹ãƒˆ"""

    def test_detect_alias_pattern_1(self):
        """ã€Œã€‡ã€‡ã¯â–³â–³ã ã‚ˆã€ãƒ‘ã‚¿ãƒ¼ãƒ³"""
        detector = FeedbackDetector(DETECTION_PATTERNS)
        result = detector.detect("éº»ç¾ã¯æ¸¡éƒ¨éº»ç¾ã®ã“ã¨ã ã‚ˆ")

        assert result is not None
        assert result.pattern.name == "alias_definition"
        assert result.confidence >= 0.7

    def test_detect_alias_pattern_2(self):
        """ã€Œã€‡ã€‡ã˜ã‚ƒãªãã¦â–³â–³ã€ãƒ‘ã‚¿ãƒ¼ãƒ³"""
        detector = FeedbackDetector(DETECTION_PATTERNS)
        result = detector.detect("ç”°ä¸­ã˜ã‚ƒãªãã¦ä½è—¤ã ã‚ˆ")

        assert result is not None
        assert result.pattern.name == "correction"

    def test_detect_rule_pattern(self):
        """ãƒ«ãƒ¼ãƒ«æ•™ç¤ºãƒ‘ã‚¿ãƒ¼ãƒ³"""
        detector = FeedbackDetector(DETECTION_PATTERNS)
        result = detector.detect("æ€¥ãã®æ™‚ã¯å…ˆã«DMã§é€£çµ¡ã—ã¦")

        assert result is not None
        assert result.pattern.name == "rule_definition"

    def test_no_feedback_in_normal_message(self):
        """é€šå¸¸ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã§ã¯æ¤œå‡ºã—ãªã„"""
        detector = FeedbackDetector(DETECTION_PATTERNS)
        result = detector.detect("ä»Šæ—¥ã®ä¼šè­°ã¯ä½•æ™‚ã‹ã‚‰ï¼Ÿ")

        assert result is None
```

```python
# tests/test_learning_extractor.py

class TestLearningExtractor:
    """å­¦ç¿’å†…å®¹æŠ½å‡ºã®ãƒ†ã‚¹ãƒˆ"""

    def test_extract_alias(self):
        """åˆ¥åã®æŠ½å‡º"""
        extractor = LearningExtractor()
        detection = FeedbackDetectionResult(
            pattern=PATTERNS["alias_definition"],
            match={"from": "éº»ç¾", "to": "æ¸¡éƒ¨éº»ç¾"},
            confidence=0.9
        )

        learning = extractor.extract(detection, "éº»ç¾ã¯æ¸¡éƒ¨éº»ç¾ã®ã“ã¨ã ã‚ˆ")

        assert learning.category == "alias"
        assert learning.learned_content["from"] == "éº»ç¾"
        assert learning.learned_content["to"] == "æ¸¡éƒ¨éº»ç¾"

    def test_extract_with_authority_level(self):
        """æ¨©é™ãƒ¬ãƒ™ãƒ«ä»˜ãæŠ½å‡º"""
        extractor = LearningExtractor()
        learning = extractor.extract(
            detection, message,
            taught_by_authority='manager'
        )
        assert learning.authority_level == 'manager'
```

```python
# tests/test_learning_applier.py

class TestLearningApplier:
    """å­¦ç¿’é©ç”¨ã®ãƒ†ã‚¹ãƒˆ"""

    async def test_apply_alias_in_understanding(self):
        """ç†è§£å±¤ã§ã®åˆ¥åé©ç”¨"""
        # äº‹å‰ã«å­¦ç¿’ã‚’ä¿å­˜
        await repository.save(Learning(
            category="alias",
            trigger_type="keyword",
            trigger_value="éº»ç¾",
            learned_content={"from": "éº»ç¾", "to": "æ¸¡éƒ¨éº»ç¾"}
        ))

        applier = LearningApplier(repository, ceo_repo)
        resolved, applied = await applier.apply_to_understanding(
            "éº»ç¾ã®ã‚¿ã‚¹ã‚¯æ•™ãˆã¦",
            user_id="1234",
            room_id="5678"
        )

        assert "æ¸¡éƒ¨éº»ç¾" in resolved or len(applied) > 0

    async def test_ceo_teaching_takes_precedence(self):
        """CEOæ•™ãˆãŒå­¦ç¿’ã‚ˆã‚Šå„ªå…ˆã•ã‚Œã‚‹"""
        # CEOæ•™ãˆ: å ±å‘Šã¯æ¯æ—¥17æ™‚
        await ceo_repo.save(CEOTeaching(
            statement="å ±å‘Šã¯æ¯æ—¥17æ™‚ã«è¡Œã†",
            category="rule"
        ))
        # ä¸€èˆ¬å­¦ç¿’: å ±å‘Šã¯æ¯é€±æœˆæ›œ
        await repository.save(Learning(
            category="rule",
            learned_content={"condition": "å ±å‘Š", "action": "æ¯é€±æœˆæ›œ"},
            authority_level='user'
        ))

        applier = LearningApplier(repository, ceo_repo)
        # CEOæ•™ãˆã¨çŸ›ç›¾ã™ã‚‹å­¦ç¿’ã¯é™¤å¤–ã•ã‚Œã‚‹
        learnings = await applier._filter_conflicting_with_ceo(...)
        assert len(learnings) == 0
```

```python
# tests/test_conflict_detector.py

class TestConflictDetector:
    """çŸ›ç›¾æ¤œå‡ºã®ãƒ†ã‚¹ãƒˆ"""

    async def test_detect_alias_conflict(self):
        """åŒã˜ç•¥ç§°ã«ç•°ãªã‚‹æ­£å¼åç§°"""
        existing = Learning(
            trigger_value="éº»ç¾",
            learned_content={"from": "éº»ç¾", "to": "æ¸¡éƒ¨éº»ç¾"}
        )
        new = Learning(
            trigger_value="éº»ç¾",
            learned_content={"from": "éº»ç¾", "to": "æµ…äº•éº»ç¾"}
        )

        detector = ConflictDetector(repository)
        conflicts = await detector.detect_conflicts(new, [existing])

        assert len(conflicts) == 1
        assert conflicts[0].conflict_type == "content_mismatch"

    async def test_resolve_conflict_newer_wins(self):
        """newer_winsæˆ¦ç•¥ã§è§£æ±º"""
        detector = ConflictDetector(repository)
        resolution = await detector.resolve_conflict(
            conflict,
            resolution_strategy='newer_wins'
        )

        assert resolution.action == 'superseded'
        # æ—§å­¦ç¿’ãŒç„¡åŠ¹åŒ–ã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèª

    async def test_no_conflict_different_trigger(self):
        """ç•°ãªã‚‹ãƒˆãƒªã‚¬ãƒ¼ã¯çŸ›ç›¾ã—ãªã„"""
        existing = Learning(trigger_value="éº»ç¾", ...)
        new = Learning(trigger_value="å´‡æ¨¹", ...)

        conflicts = await detector.detect_conflicts(new, [existing])
        assert len(conflicts) == 0
```

```python
# tests/test_authority_resolver.py

class TestAuthorityResolver:
    """æ¨©é™ãƒ¬ãƒ™ãƒ«è§£æ±ºã®ãƒ†ã‚¹ãƒˆ"""

    def test_ceo_has_highest_priority(self):
        """CEOãŒæœ€é«˜å„ªå…ˆåº¦"""
        resolver = AuthorityResolver()
        assert resolver.get_priority('ceo') < resolver.get_priority('manager')
        assert resolver.get_priority('manager') < resolver.get_priority('user')
        assert resolver.get_priority('user') < resolver.get_priority('system')

    def test_can_override_lower_authority(self):
        """ä½ã„æ¨©é™ã¯ä¸Šæ›¸ãå¯èƒ½"""
        resolver = AuthorityResolver()
        assert resolver.can_override('ceo', 'user') == True
        assert resolver.can_override('user', 'ceo') == False
```

### 9.2 çµ±åˆãƒ†ã‚¹ãƒˆ

```python
# tests/test_learning_integration.py

class TestLearningIntegration:
    """å­¦ç¿’æ©Ÿèƒ½ã®çµ±åˆãƒ†ã‚¹ãƒˆ"""

    async def test_full_learning_cycle(self):
        """å­¦ç¿’â†’é©ç”¨ã®å®Œå…¨ã‚µã‚¤ã‚¯ãƒ«"""
        brain = SoulkunBrain(pool=pool, org_id="test")

        # 1. æ•™ãˆã‚‹
        response1 = await brain.process_message(
            message="éº»ç¾ã¯æ¸¡éƒ¨éº»ç¾ã®ã“ã¨ã ã‚ˆ",
            room_id="123",
            account_id="456",
            sender_name="ã‚«ã‚º"
        )
        assert "è¦šãˆãŸ" in response1.message

        # 2. é©ç”¨ã‚’ç¢ºèª
        response2 = await brain.process_message(
            message="éº»ç¾ã®ã‚¿ã‚¹ã‚¯æ•™ãˆã¦",
            room_id="123",
            account_id="456",
            sender_name="ã‚«ã‚º"
        )
        # ã€Œæ¸¡éƒ¨éº»ç¾ã€ã¨ã—ã¦å‡¦ç†ã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª
        assert "æ¸¡éƒ¨éº»ç¾" in response2.message or response2.action_taken == "task_search"

    async def test_learning_persistence(self):
        """å­¦ç¿’ã®æ°¸ç¶šæ€§"""
        brain1 = SoulkunBrain(pool=pool, org_id="test")

        # æ•™ãˆã‚‹
        await brain1.process_message(
            message="ã‚¿ã‚«ã¯é«˜æ©‹ã•ã‚“ã®ã“ã¨ã ã‚ˆ",
            room_id="123",
            account_id="456",
            sender_name="ã‚«ã‚º"
        )

        # åˆ¥ã®brainã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã§ç¢ºèª
        brain2 = SoulkunBrain(pool=pool, org_id="test")

        response = await brain2.process_message(
            message="ã‚¿ã‚«ã®ã‚¿ã‚¹ã‚¯æ•™ãˆã¦",
            room_id="123",
            account_id="456",
            sender_name="ã‚«ã‚º"
        )

        # æ–°ã—ã„ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã§ã‚‚å­¦ç¿’ãŒé©ç”¨ã•ã‚Œã‚‹
        assert "é«˜æ©‹" in response.message or response.action_taken == "task_search"

    async def test_ceo_teaching_conflict_rejected(self):
        """CEOæ•™ãˆã¨çŸ›ç›¾ã™ã‚‹å­¦ç¿’ã¯æ‹’å¦ã•ã‚Œã‚‹"""
        brain = SoulkunBrain(pool=pool, org_id="test")

        # CEOæ•™ãˆã‚’è¨­å®š
        await ceo_repo.save(CEOTeaching(
            statement="å ±å‘Šã¯æ¯æ—¥17æ™‚ã«è¡Œã†"
        ))

        # çŸ›ç›¾ã™ã‚‹å­¦ç¿’ã‚’è©¦ã¿ã‚‹
        response = await brain.process_message(
            message="å ±å‘Šã¯æ¯é€±æœˆæ›œã§ã„ã„ã‚ˆ",
            room_id="123",
            account_id="789",  # ä¸€èˆ¬ãƒ¦ãƒ¼ã‚¶ãƒ¼
            sender_name="å±±ç”°"
        )

        assert "è¦šãˆã‚‹ã“ã¨ãŒã§ããªã„" in response.message
        assert response.action_taken == "learning_rejected_ceo_conflict"

    async def test_supersedes_chain(self):
        """å­¦ç¿’ã®ä¸Šæ›¸ããƒã‚§ãƒ¼ãƒ³"""
        brain = SoulkunBrain(pool=pool, org_id="test")

        # å­¦ç¿’1
        await brain.process_message("éº»ç¾ã¯æ¸¡éƒ¨éº»ç¾ã ã‚ˆ", ...)
        # å­¦ç¿’2ï¼ˆå­¦ç¿’1ã‚’ä¸Šæ›¸ãï¼‰
        await brain.process_message("éº»ç¾ã¯æµ…äº•éº»ç¾ã ã‚ˆ", ...)
        # å­¦ç¿’3ï¼ˆå­¦ç¿’2ã‚’ä¸Šæ›¸ãï¼‰
        await brain.process_message("éº»ç¾ã¯å±±ç”°éº»ç¾ã ã‚ˆ", ...)

        # æœ€æ–°ã®å­¦ç¿’ã®ã¿ãŒã‚¢ã‚¯ãƒ†ã‚£ãƒ–
        learnings = await repository.find_by_trigger("éº»ç¾")
        active = [l for l in learnings if l.is_active]
        assert len(active) == 1
        assert active[0].learned_content["to"] == "å±±ç”°éº»ç¾"
```

```python
# tests/test_learning_performance.py

class TestLearningPerformance:
    """ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆ"""

    async def test_search_with_10000_learnings(self):
        """10,000ä»¶ã®å­¦ç¿’ã‹ã‚‰æ¤œç´¢"""
        # 10,000ä»¶ã®ãƒ€ãƒŸãƒ¼å­¦ç¿’ã‚’ä½œæˆ
        for i in range(10000):
            await repository.save(Learning(
                trigger_value=f"keyword_{i}",
                learned_content={"value": f"content_{i}"}
            ))

        start = time.time()
        await applier.apply_to_understanding(
            "keyword_5000ã®ã‚¿ã‚¹ã‚¯",
            user_id="test",
            room_id="test"
        )
        elapsed = (time.time() - start) * 1000

        assert elapsed < 100  # 100msä»¥å†…

    async def test_concurrent_learning_writes(self):
        """åŒæ™‚ã«10ä»¶ã®å­¦ç¿’ã‚’æ›¸ãè¾¼ã¿"""
        tasks = [
            repository.save(Learning(trigger_value=f"concurrent_{i}", ...))
            for i in range(10)
        ]

        # ãƒ‡ãƒƒãƒ‰ãƒ­ãƒƒã‚¯ãªãå®Œäº†ã™ã‚‹ã“ã¨ã‚’ç¢ºèª
        results = await asyncio.gather(*tasks, return_exceptions=True)
        errors = [r for r in results if isinstance(r, Exception)]
        assert len(errors) == 0
```

### 9.3 ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ä¸€è¦§

| ã‚«ãƒ†ã‚´ãƒª | ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹æ•° | å†…å®¹ |
|---------|--------------|------|
| æ¤œå‡º | 30 | 15ãƒ‘ã‚¿ãƒ¼ãƒ³ Ã— æ­£å¸¸/ç•°å¸¸ |
| æŠ½å‡º | 16 | 8ã‚«ãƒ†ã‚´ãƒª Ã— æ­£å¸¸/ç•°å¸¸ |
| ä¿å­˜ | 10 | CRUDæ“ä½œ |
| é©ç”¨ | 20 | å„å±¤ã§ã®é©ç”¨ |
| ç®¡ç† | 10 | ä¸€è¦§/å‰Šé™¤/ä¿®æ­£ |
| çŸ›ç›¾æ¤œå‡º | 15 | çŸ›ç›¾æ¤œå‡ºãƒ»è§£æ±º â˜…è¿½åŠ  |
| Phase 2Dçµ±åˆ | 10 | CEOæ•™ãˆå„ªå…ˆ â˜…è¿½åŠ  |
| æ¨©é™ãƒ¬ãƒ™ãƒ« | 5 | æ¨©é™è§£æ±º â˜…è¿½åŠ  |
| supersedesé€£é– | 5 | ä¸Šæ›¸ãé€£é– â˜…è¿½åŠ  |
| ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ | 5 | å¤§é‡ãƒ‡ãƒ¼ã‚¿ã€ä¸¦è¡Œå‡¦ç† â˜…è¿½åŠ  |
| çµ±åˆ | 10 | E2Eãƒ•ãƒ­ãƒ¼ |
| **åˆè¨ˆ** | **136** | |

---

## 10. ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³è¨ˆç”»

### 10.1 DBãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³

```sql
-- migrations/phase2e_learning_foundation.sql

BEGIN;

-- 1. brain_learnings ãƒ†ãƒ¼ãƒ–ãƒ«ä½œæˆ
-- ï¼ˆ4.1.1 ã®å®šç¾©ã‚’ä½¿ç”¨ï¼‰

-- 2. brain_learning_logs ãƒ†ãƒ¼ãƒ–ãƒ«ä½œæˆ
-- ï¼ˆ4.1.2 ã®å®šç¾©ã‚’ä½¿ç”¨ï¼‰

-- 3. ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ä½œæˆ
-- ï¼ˆ4.1.1, 4.1.2 ã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹å®šç¾©ã‚’ä½¿ç”¨ï¼‰

-- 4. ãƒˆãƒªã‚¬ãƒ¼ä½œæˆ
CREATE TRIGGER update_brain_learnings_updated_at
    BEFORE UPDATE ON brain_learnings
    FOR EACH ROW
    EXECUTE FUNCTION update_updated_at_column();

COMMIT;
```

### 10.2 ã‚³ãƒ¼ãƒ‰ãƒ‡ãƒ—ãƒ­ã‚¤

```
1. lib/brain/learning/ ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ä½œæˆ
2. å„ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’å®Ÿè£…
   - detector.py
   - extractor.py
   - repository.py
   - applier.py
   - manager.py
   - patterns.py
   - conflict_detector.py â˜…æ–°è¦
   - authority_resolver.py â˜…æ–°è¦
   - effectiveness_tracker.py â˜…æ–°è¦
3. lib/brain/core.py ã‚’æ›´æ–°
4. chatwork-webhook/lib/brain/ ã«åŒæœŸ
5. ãƒ†ã‚¹ãƒˆå®Ÿè¡Œï¼ˆ136ä»¶ãƒ‘ã‚¹ç¢ºèªï¼‰
6. PRä½œæˆ â†’ Quality Checks â†’ ãƒãƒ¼ã‚¸
7. DBãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œ
8. chatwork-webhook ãƒ‡ãƒ—ãƒ­ã‚¤
```

### 10.3 Feature Flag

```python
# ç’°å¢ƒå¤‰æ•°
USE_LEARNING_FOUNDATION = os.environ.get("USE_LEARNING_FOUNDATION", "false")

# core.py ã§ã®åˆ†å²
if USE_LEARNING_FOUNDATION == "true":
    # Phase 2E ã®å­¦ç¿’æ©Ÿèƒ½ã‚’ä½¿ç”¨
    feedback = self.feedback_detector.detect(message, context)
    if feedback:
        return await self._handle_feedback(feedback, ...)
else:
    # å¾“æ¥ã®å‡¦ç†ï¼ˆå­¦ç¿’æ©Ÿèƒ½ãªã—ï¼‰
    pass
```

---

## 11. æˆåŠŸåŸºæº–

### 11.1 æ©Ÿèƒ½çš„æˆåŠŸåŸºæº–

| # | åŸºæº– | è¨ˆæ¸¬æ–¹æ³• |
|---|------|---------|
| 1 | 15ç¨®ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã§å­¦ç¿’ã‚’æ¤œå‡ºã§ãã‚‹ | ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆ |
| 2 | 8ã‚«ãƒ†ã‚´ãƒªã®å­¦ç¿’ã‚’æ­£ã—ãä¿å­˜ã§ãã‚‹ | ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆ |
| 3 | ä¿å­˜ã—ãŸå­¦ç¿’ãŒæ¬¡å›ã‹ã‚‰é©ç”¨ã•ã‚Œã‚‹ | çµ±åˆãƒ†ã‚¹ãƒˆ |
| 4 | å­¦ç¿’ä¸€è¦§ã‚’ç¢ºèªã§ãã‚‹ | æ‰‹å‹•ãƒ†ã‚¹ãƒˆ |
| 5 | å­¦ç¿’ã‚’å‰Šé™¤ãƒ»ä¿®æ­£ã§ãã‚‹ | æ‰‹å‹•ãƒ†ã‚¹ãƒˆ |
| 6 | CEOæ•™ãˆã¨çŸ›ç›¾ã™ã‚‹å­¦ç¿’ã¯æ‹’å¦ã•ã‚Œã‚‹ | çµ±åˆãƒ†ã‚¹ãƒˆ â˜…è¿½åŠ  |
| 7 | æ—¢å­˜å­¦ç¿’ã¨ã®çŸ›ç›¾ã¯è‡ªå‹•è§£æ±ºã•ã‚Œã‚‹ | çµ±åˆãƒ†ã‚¹ãƒˆ â˜…è¿½åŠ  |

### 11.2 å“è³ªåŸºæº–

| # | åŸºæº– | ç›®æ¨™å€¤ |
|---|------|--------|
| 1 | ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸ | 80%ä»¥ä¸Š |
| 2 | å…¨ãƒ†ã‚¹ãƒˆãƒ‘ã‚¹ | 136ä»¶ |
| 3 | æ¤œå‡ºç²¾åº¦ï¼ˆé©åˆç‡ï¼‰ | 90%ä»¥ä¸Š |
| 4 | æ¤œå‡ºç²¾åº¦ï¼ˆå†ç¾ç‡ï¼‰ | 80%ä»¥ä¸Š |

### 11.3 é‹ç”¨åŸºæº–

| # | åŸºæº– | ç›®æ¨™å€¤ |
|---|------|--------|
| 1 | å­¦ç¿’å‡¦ç†ã®å¿œç­”æ™‚é–“ | 2ç§’ä»¥å†… |
| 2 | å­¦ç¿’é©ç”¨ã®å¿œç­”æ™‚é–“è¿½åŠ  | 100msä»¥å†… |
| 3 | DBå®¹é‡ï¼ˆ1ãƒ¶æœˆã‚ãŸã‚Šï¼‰ | 10MBä»¥ä¸‹ |
| 4 | 10,000ä»¶å­¦ç¿’æ™‚ã®æ¤œç´¢æ™‚é–“ | 100msä»¥å†… â˜…è¿½åŠ  |

---

## 12. ãƒªã‚¹ã‚¯ã¨å¯¾ç­–

### 12.1 æŠ€è¡“çš„ãƒªã‚¹ã‚¯

| ãƒªã‚¹ã‚¯ | å½±éŸ¿ | å¯¾ç­– |
|--------|------|------|
| èª¤æ¤œå‡ºï¼ˆæœ¬æ¥ã®ä¼šè©±ã‚’å­¦ç¿’ã¨èª¤èªï¼‰ | ä¸è¦ãªå­¦ç¿’ãŒä¿å­˜ã•ã‚Œã‚‹ | ç¢ºä¿¡åº¦é–¾å€¤0.7ã€ç¢ºèªãƒ¢ãƒ¼ãƒ‰ |
| è¦‹é€ƒã—ï¼ˆå­¦ç¿’ã‚’æ¤œå‡ºã§ããªã„ï¼‰ | æ•™ãˆã¦ã‚‚è¦šãˆãªã„ | ãƒ‘ã‚¿ãƒ¼ãƒ³ã®ç¶™ç¶šçš„è¿½åŠ  |
| çŸ›ç›¾ã™ã‚‹å­¦ç¿’ | å¤ã„å­¦ç¿’ã¨æ–°ã—ã„å­¦ç¿’ãŒè¡çª | supersedes/superseded_byã§ç®¡ç† |
| æ€§èƒ½åŠ£åŒ– | å­¦ç¿’ãŒå¢—ãˆã‚‹ã¨é…ããªã‚‹ | ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹æœ€é©åŒ–ã€ã‚­ãƒ£ãƒƒã‚·ãƒ¥ |
| CEOæ•™ãˆã¨ã®çŸ›ç›¾ | ä¼šç¤¾æ–¹é‡ã¨ç•°ãªã‚‹å­¦ç¿’ | CEOæ•™ãˆå„ªå…ˆãƒã‚§ãƒƒã‚¯ â˜…è¿½åŠ  |

### 12.2 é‹ç”¨ãƒªã‚¹ã‚¯

| ãƒªã‚¹ã‚¯ | å½±éŸ¿ | å¯¾ç­– |
|--------|------|------|
| é–“é•ã£ãŸå­¦ç¿’ | èª¤å‹•ä½œ | å‰Šé™¤æ©Ÿèƒ½ã€ç¢ºèªãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ |
| å­¦ç¿’ã®ä¹±ç”¨ | æ„å›³ã—ãªã„å‹•ä½œ | CEO/ç®¡ç†è€…ã®ã¿å­¦ç¿’å¯èƒ½ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰ |
| å€‹äººæƒ…å ±ã®å­¦ç¿’ | ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼å•é¡Œ | classification=confidential |

---

## 13. ä»Šå¾Œã®æ‹¡å¼µï¼ˆPhase 2Fä»¥é™ã¨ã®é€£æºï¼‰

### 13.1 Phase 2Fï¼ˆçµæœã‹ã‚‰ã®å­¦ç¿’ï¼‰ã¨ã®é€£æº

```
Phase 2E: æ˜ç¤ºçš„ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã€Œé•ã†ã‚ˆã€â†’ å­¦ç¿’
Phase 2F: æš—é»™ã®ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ï¼ˆå‰Šé™¤ã•ã‚ŒãŸã€ç„¡è¦–ã•ã‚ŒãŸï¼‰â†’ å­¦ç¿’

ä¸¡è€…ã¯åŒã˜ brain_learnings ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ä½¿ç”¨ã—ã€
detection_pattern ã§åŒºåˆ¥ã™ã‚‹:
- Phase 2E: "explicit_*"
- Phase 2F: "implicit_*"
```

### 13.2 Phase 2Gï¼ˆè¨˜æ†¶ã®å¼·åŒ–ï¼‰ã¨ã®é€£æº

```
Phase 2E: å€‹åˆ¥ã®å­¦ç¿’
Phase 2G: å­¦ç¿’åŒå£«ã®é–¢é€£ä»˜ã‘ï¼ˆçŸ¥è­˜ã‚°ãƒ©ãƒ•ï¼‰

æº–å‚™æ¸ˆã¿ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰:
- related_learning_ids: é–¢é€£ã™ã‚‹å­¦ç¿’ã®IDé…åˆ—
- relationship_type: implies, contradicts, extends, specializes
- confidence_decay_rate: æ™‚é–“çµŒéã«ã‚ˆã‚‹ç¢ºä¿¡åº¦ä½ä¸‹

ä¾‹:
- ã€Œéº»ç¾ã€â†’ã€Œæ¸¡éƒ¨éº»ç¾ã€ï¼ˆPhase 2Eï¼‰
- ã€Œæ¸¡éƒ¨éº»ç¾ã€â†’ã€ŒçµŒç†æ‹…å½“ã€ï¼ˆPhase 2Eï¼‰
- ã€Œéº»ç¾ã€â†’ã€ŒçµŒç†æ‹…å½“ã€ã‚’è‡ªå‹•æ¨è«–ï¼ˆPhase 2Gï¼‰
```

### 13.3 Phase 2Hï¼ˆè‡ªå·±èªè­˜ï¼‰ã¨ã®é€£æº

```
Phase 2E: æ˜ç¤ºçš„ã«æ•™ãˆã‚‰ã‚ŒãŸçŸ¥è­˜
Phase 2H: ã€Œåˆ†ã‹ã‚‰ãªã‹ã£ãŸã€ãƒ‘ã‚¿ãƒ¼ãƒ³ã®èªè­˜

æº–å‚™æ¸ˆã¿ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰:
- unknown_pattern: ã€Œåˆ†ã‹ã‚‰ãªã‹ã£ãŸã€ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’è¨˜éŒ²
- clarification_count: ç¢ºèªã‚’æ±‚ã‚ãŸå›æ•°

ä¾‹:
- ç¢ºä¿¡åº¦ãŒä½ã‹ã£ãŸè³ªå•ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’è¨˜éŒ²
- ä½•åº¦ã‚‚ç¢ºèªã‚’æ±‚ã‚ã¦ã„ã‚‹ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’åˆ†æ
- ã€Œã€‡ã€‡ã«ã¤ã„ã¦ã¯è©³ã—ããªã„ã‚¦ãƒ«ã€ã¨è‡ªå·±èªè­˜
```

### 13.4 Phase 2Nï¼ˆè‡ªå·±æœ€é©åŒ–ï¼‰ã¨ã®é€£æº

```
Phase 2E: å­¦ç¿’ã®ä¿å­˜ãƒ»é©ç”¨
Phase 2N: å­¦ç¿’åŠ¹æœã®æ¸¬å®šãƒ»æœ€é©åŒ–

æº–å‚™æ¸ˆã¿ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰:
- effectiveness_score: å­¦ç¿’ã®åŠ¹æœã‚¹ã‚³ã‚¢ (0.0-1.0)
- last_effectiveness_check: æœ€çµ‚åŠ¹æœæ¸¬å®šæ—¥æ™‚
- decision_impact: positive, negative, neutral

EffectivenessTrackerã‚¯ãƒ©ã‚¹ã§:
- å­¦ç¿’é©ç”¨çµæœã‚’è¨˜éŒ²
- åŠ¹æœã‚¹ã‚³ã‚¢ã‚’è¨ˆç®—
- åŠ¹æœã®ä½ã„å­¦ç¿’ã‚’ç‰¹å®š
- æ”¹å–„ææ¡ˆã‚’ç”Ÿæˆ
```

---

## 14. å¤‰æ›´å±¥æ­´

| ãƒãƒ¼ã‚¸ãƒ§ãƒ³ | æ—¥ä»˜ | å¤‰æ›´å†…å®¹ |
|-----------|------|---------|
| 1.0.0 | 2026-01-27 | åˆç‰ˆä½œæˆ |
| 1.1.0 | 2026-01-27 | ãƒ€ãƒ–ãƒ«ãƒã‚§ãƒƒã‚¯åæ˜ : Phase 2Dé€£æºã€çŸ›ç›¾æ¤œå‡ºã€æ¨©é™ãƒ¬ãƒ™ãƒ«ã€Phase 2F-2Oæ¥ç¶šãƒã‚¤ãƒ³ãƒˆè¿½åŠ  |

---

## 15. æ‰¿èª

| å½¹å‰² | åå‰ | æ—¥ä»˜ | æ‰¿èª |
|------|------|------|------|
| è¨­è¨ˆè€… | Claude Code | 2026-01-27 | âœ… |
| ãƒ€ãƒ–ãƒ«ãƒã‚§ãƒƒã‚¯ | Claude Code | 2026-01-27 | âœ… |
| ãƒ¬ãƒ“ãƒ¥ã‚¢ãƒ¼ | - | - | ğŸ“‹ |
| æ‰¿èªè€…ï¼ˆã‚«ã‚ºã•ã‚“ï¼‰ | - | - | ğŸ“‹ |
